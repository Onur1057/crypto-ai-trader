var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{r as a,a as s}from"./vendor-9fiDQRhm.js";import{S as i,T as r,a as n,M as l,B as o,U as c,b as d,c as m,X as g,I as h,d as x,e as u,f as p,g as y,h as b,A as f,i as v,F as k,j,G as N,L as S,E as w,N as D,k as _,D as A,l as T,Z as P,R as C,C as z,m as L,n as I,o as $,p as E,P as R,q as F,r as M,s as O}from"./utils-8hX8dgY1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var B={exports:{}},U={},K=a,H=Symbol.for("react.element"),G=Symbol.for("react.fragment"),J=Object.prototype.hasOwnProperty,Y=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W={key:!0,ref:!0,__self:!0,__source:!0};function V(e,t,a){var s,i={},r=null,n=null;for(s in void 0!==a&&(r=""+a),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(n=t.ref),t)J.call(t,s)&&!W.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===i[s]&&(i[s]=t[s]);return{$$typeof:H,type:e,key:r,ref:n,props:i,_owner:Y.current}}U.Fragment=G,U.jsx=V,U.jsxs=V,B.exports=U;var X,Z=B.exports,q=s;X=q.createRoot,q.hydrateRoot;const Q=({coins:e,selectedCoin:t,onCoinSelect:s,loading:l=!1})=>{const[o,c]=a.useState(""),[d,m]=a.useState(e);return a.useEffect(()=>{const t=e.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.symbol.toLowerCase().includes(o.toLowerCase()));m(t)},[e,o]),l?Z.jsx("div",{className:"space-y-2",children:[...Array(5)].map((e,t)=>Z.jsx("div",{className:"animate-pulse",children:Z.jsx("div",{className:"h-12 bg-gray-200 rounded"})},t))}):Z.jsxs("div",{className:"space-y-4",children:[Z.jsxs("div",{className:"relative",children:[Z.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Z.jsx("input",{type:"text",placeholder:"Coin ara...",value:o,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),Z.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:d.map(e=>Z.jsx("button",{onClick:()=>s(e),className:"w-full p-3 text-left rounded-lg border transition-colors "+((null==t?void 0:t.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("div",{className:"font-medium text-gray-800",children:e.symbol.toUpperCase()}),Z.jsx("div",{className:"text-sm text-gray-500",children:e.name})]}),Z.jsxs("div",{className:"text-right",children:[Z.jsxs("div",{className:"text-sm font-semibold text-gray-800",children:["$",e.current_price.toLocaleString()]}),Z.jsxs("div",{className:"text-xs flex items-center "+(e.price_change_percentage_24h>=0?"text-green-600":"text-red-600"),children:[e.price_change_percentage_24h>=0?Z.jsx(r,{className:"w-3 h-3 mr-1"}):Z.jsx(n,{className:"w-3 h-3 mr-1"}),e.price_change_percentage_24h>=0?"+":"",e.price_change_percentage_24h.toFixed(2),"%"]})]})]})},e.id))}),0===d.length&&o&&Z.jsx("div",{className:"text-center py-4 text-gray-500",children:Z.jsxs("p",{children:['"',o,'" için sonuç bulunamadı']})})]})},ee={openaiApiKey:"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",baseUrl:"https://api.openai.com/v1",coingeckoApiKey:"CG-nQRRy8W23HDLBmJTGgi2VNeh",coingeckoBaseUrl:"https://api.coingecko.com/api/v3",binanceApiKey:void 0,binanceSecretKey:void 0,binanceBaseUrl:"https://api.binance.com/api/v3"};const te=new class{constructor(){t(this,"apiKey",ee.openaiApiKey),t(this,"baseUrl",ee.baseUrl)}async sendMessage(e,t,a){var s;try{if(!this.apiKey)throw new Error("OpenAI API anahtarı bulunamadı");const a=this.buildSystemPrompt(t),i=(e[e.length-1],[{role:"system",content:a},...e.slice(-10).map(e=>({role:e.role,content:e.content}))]),r=await fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4",messages:i,temperature:.7,max_tokens:1500})});if(!r.ok){const e=await r.json().catch(()=>({}));throw new Error(`API Hatası: ${r.status} - ${(null==(s=e.error)?void 0:s.message)||"Bilinmeyen hata"}`)}return(await r.json()).choices[0].message.content}catch(i){throw console.error("Chat servisi hatası:",i),i}}buildSystemPrompt(e){const t="\nSen profesyonel bir AI Trading Koçusun. Türkçe konuşuyorsun ve kullanıcılara trading konularında yardım ediyorsun.\n\nUZMANLIK ALANLARIN:\n- Price Action analizi\n- Teknik analiz ve göstergeler\n- Risk yönetimi\n- Chart pattern'leri\n- Candlestick formasyonları\n- Market psikolojisi\n- Trading stratejileri\n\nYAKLAŞIMIN:\n- Samimi ve dostane\n- Eğitici ve açıklayıcı\n- Pratik örnekler ver\n- Risk uyarıları yap\n- Emojiler kullan\n- Kısa ve net cevaplar\n\nKURALLARIN:\n- Finansal tavsiye verme, sadece eğitim\n- Her zaman risk uyarısı yap\n- Kaynak belirt\n- Örneklerle açıkla\n    ";return e?t+`\n\nMEVCUT COIN: ${e.name} (${e.symbol.toUpperCase()})\n- Fiyat: $${e.current_price.toLocaleString()}\n- 24s Değişim: ${e.price_change_percentage_24h.toFixed(2)}%\n- Market Cap: $${e.market_cap.toLocaleString()}\n- Hacim: $${e.total_volume.toLocaleString()}\n- 24s Yüksek: $${e.high_24h.toLocaleString()}\n- 24s Düşük: $${e.low_24h.toLocaleString()}\n\nBu coin hakkında sorular gelirse bu verileri kullan.\n      `:t}};const ae=new class{constructor(){t(this,"storageKey","learning_data"),t(this,"userId","default_user")}createDefaultLearningData(e){return{userId:e,interactions:[],preferences:{tradingStyle:"mixed",riskTolerance:"medium",preferredTimeframes:["1h","4h","1d"],favoriteIndicators:["RSI","MACD","SMA"],learningGoals:[]},performance:{correctPredictions:0,totalPredictions:0,userSatisfaction:0,topicsLearned:[]}}}loadLearningData(){try{const e=localStorage.getItem(this.storageKey);if(e){const t=JSON.parse(e);return t.interactions=t.interactions.map(e=>({...e,timestamp:new Date(e.timestamp)})),t}}catch(e){console.error("Öğrenme verisi yükleme hatası:",e)}return this.createDefaultLearningData(this.userId)}saveLearningData(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){console.error("Öğrenme verisi kaydetme hatası:",t)}}saveInteraction(e){const t=this.loadLearningData(),a=this.extractTopics(e.content),s=this.extractCoins(e.content),i=this.extractPatterns(e.content);e.tags=[...a,...s,...i],t.interactions.push(e),t.interactions.length>1e3&&(t.interactions=t.interactions.slice(-1e3)),a.length>0&&(t.performance.topicsLearned=[...new Set([...t.performance.topicsLearned,...a])]),this.saveLearningData(t)}saveFeedback(e,t){const a=this.loadLearningData(),s=a.interactions.find(t=>t.id===e);if(s){s.feedback=t;const e=a.interactions.filter(e=>e.feedback).map(e=>e.feedback),i=e.filter(e=>"helpful"===e).length;a.performance.userSatisfaction=e.length>0?i/e.length*100:0,this.saveLearningData(a)}}extractTopics(e){const t=[],a={"Price Action":["price action","support","resistance","trend","breakout","destek","direnç"],"Risk Management":["risk","stop loss","position size","money management","risk yönetimi"],"Technical Analysis":["rsi","macd","moving average","bollinger","fibonacci","teknik analiz"],"Chart Patterns":["pattern","triangle","head and shoulders","flag","wedge","formasyon"],"Market Psychology":["psychology","sentiment","fear","greed","emotion","psikoloji"],"Trading Strategy":["strategy","scalping","swing","position","day trading","strateji"],"Candlestick Patterns":["candlestick","doji","hammer","engulfing","shooting star","mum"],"Volume Analysis":["volume","accumulation","distribution","volume profile","hacim"],"Market Structure":["structure","higher high","lower low","consolidation","yapı"],"Order Flow":["order flow","order book","bid","ask","liquidity","emir"],Fibonacci:["fibonacci","retracement","extension","fib"],Indicators:["indicator","oscillator","momentum","gösterge"],Timeframes:["timeframe","chart","candle","zaman dilimi"],Crypto:["bitcoin","ethereum","crypto","blockchain","kripto"],Analysis:["analysis","forecast","prediction","analiz","tahmin"]},s=e.toLowerCase();for(const[i,r]of Object.entries(a))r.some(e=>s.includes(e))&&t.push(i);return t}extractCoins(e){const t=[],a={BTC:["bitcoin","btc"],ETH:["ethereum","eth"],BNB:["binance","bnb"],ADA:["cardano","ada"],SOL:["solana","sol"],DOT:["polkadot","dot"],MATIC:["polygon","matic"],AVAX:["avalanche","avax"],LINK:["chainlink","link"],UNI:["uniswap","uni"],LTC:["litecoin","ltc"],BCH:["bitcoin cash","bch"],XRP:["ripple","xrp"],DOGE:["dogecoin","doge"],SHIB:["shiba","shib"],TRX:["tron","trx"],ATOM:["cosmos","atom"],FTM:["fantom","ftm"],NEAR:["near","near protocol"],ALGO:["algorand","algo"],VET:["vechain","vet"],ICP:["internet computer","icp"],FIL:["filecoin","fil"],HBAR:["hedera","hbar"],SAND:["sandbox","sand"],MANA:["decentraland","mana"],AXS:["axie infinity","axs"],ENJ:["enjin","enj"],CHZ:["chiliz","chz"],AAVE:["aave"],COMP:["compound","comp"]},s=e.toLowerCase();for(const[i,r]of Object.entries(a))r.some(e=>s.includes(e))&&t.push(i);return t}extractPatterns(e){const t=[],a=["head and shoulders","baş omuz","double top","double bottom","ikili tepe","ikili dip","cup and handle","kulp","triangle","üçgen","flag","bayrak","pennant","flama","wedge","kama","rectangle","dikdörtgen","channel","kanal","doji","hammer","çekiç","shooting star","kayan yıldız","engulfing","yutan","morning star","sabah yıldızı","evening star","akşam yıldızı","harami","hamile","marubozu","spinning top","topaç","bullish","bearish","boğa","ayı","yükseliş","düşüş","breakout","kırılım","support","resistance","destek","direnç","trendline","trend çizgisi"],s=e.toLowerCase();for(const i of a)s.includes(i)&&t.push(i);return t}async getAnalytics(){const e=this.loadLearningData(),t=e.interactions,a=t.length,s=e.performance.topicsLearned.length,i=Math.round(e.performance.userSatisfaction),r=new Set(t.map(e=>e.timestamp.toDateString())).size,n={};t.forEach(e=>{var t;null==(t=e.tags)||t.forEach(e=>{n[e]=(n[e]||0)+1})});const l=Object.entries(n).filter(([e])=>!["BTC","ETH","BNB"].includes(e)).sort(([,e],[,t])=>t-e).slice(0,8).map(([e,t])=>({name:e,progress:Math.min(100,Math.round(t/a*100*5))})),o=this.generateRecommendations(e,n),c=Array.from({length:7},(e,t)=>{const a=new Date;return a.setDate(a.getDate()-t),a.toDateString()}).reverse().map(e=>{const a=t.filter(t=>t.timestamp.toDateString()===e);return{date:e,interactions:a.length,topics:new Set(a.flatMap(e=>e.tags||[])).size}}),d={};t.forEach(e=>{if(e.coinContext){const t=e.coinContext.symbol.toUpperCase();d[t]=(d[t]||0)+1}});const m=Object.entries(d).sort(([,e],[,t])=>t-e).slice(0,5).map(([e,t])=>({coin:e,count:t}));return{totalInteractions:a,topicsLearned:s,successRate:i,activeDays:r,learningProgress:l,recommendations:o,dailyActivity:c,topCoins:m,topTopics:Object.entries(n).sort(([,e],[,t])=>t-e).slice(0,10).map(([e,t])=>({topic:e,count:t})),averageSessionLength:this.calculateAverageSessionLength(t),feedbackStats:this.calculateFeedbackStats(t)}}generateRecommendations(e,t){const a=[],s=e.interactions;s.length<10&&a.push("Daha fazla soru sorarak AI'dan maksimum fayda sağlayın");s.filter(e=>e.feedback).length<.3*s.length&&a.push("Yanıtlara feedback vererek AI'nın öğrenmesine yardımcı olun");Object.keys(t).length<5&&a.push("Farklı trading konularında sorular sorarak bilginizi genişletin");return s.filter(e=>e.imageData).length<3&&a.push("Grafik resimleri yükleyerek görsel analiz deneyimi yaşayın"),t["Risk Management"]||a.push("Risk yönetimi konusunda sorular sorarak güvenli trading öğrenin"),t["Chart Patterns"]||a.push("Chart pattern'leri hakkında sorular sorarak teknik analiz bilginizi artırın"),a.slice(0,5)}calculateAverageSessionLength(e){if(e.length<2)return 0;const t=[];let a=e[0].timestamp,s=e[0].timestamp;for(let r=1;r<e.length;r++){const i=e[r].timestamp;if(i.getTime()-s.getTime()>18e5){const e=s.getTime()-a.getTime();t.push(e/6e4),a=i}s=i}const i=s.getTime()-a.getTime();return t.push(i/6e4),t.length>0?t.reduce((e,t)=>e+t,0)/t.length:0}calculateFeedbackStats(e){const t=e.filter(e=>e.feedback),a=t.filter(e=>"helpful"===e.feedback).length,s=t.filter(e=>"not_helpful"===e.feedback).length;return{total:t.length,helpful:a,notHelpful:s,helpfulRate:t.length>0?a/t.length*100:0}}updatePreferences(e){const t=this.loadLearningData();t.preferences={...t.preferences,...e},this.saveLearningData(t)}updatePerformance(e){const t=this.loadLearningData();t.performance={...t.performance,...e},this.saveLearningData(t)}clearLearningData(){localStorage.removeItem(this.storageKey)}exportLearningData(){const e=this.loadLearningData();return JSON.stringify(e,null,2)}importLearningData(e){try{const t=JSON.parse(e);return this.saveLearningData(t),!0}catch(t){return console.error("Import hatası:",t),!1}}},se=({currentCoin:e,chartImage:t})=>{const[s,i]=a.useState([]),[r,n]=a.useState(""),[u,p]=a.useState(!1),[y,b]=a.useState(""),f=a.useRef(null);a.useEffect(()=>{var e;null==(e=f.current)||e.scrollIntoView({behavior:"smooth"})},[s]),a.useEffect(()=>{if(e){const t={id:Date.now().toString(),role:"assistant",content:`📊 ${e.name} (${e.symbol.toUpperCase()}) seçildi!\n\nMevcut fiyat: $${e.current_price.toLocaleString()}\n24s değişim: ${e.price_change_percentage_24h>=0?"📈":"📉"} ${e.price_change_percentage_24h.toFixed(2)}%\n\nBu coin hakkında ne öğrenmek istiyorsun? Price action analizi, risk yönetimi veya teknik formasyon sorularını sorabilirsin! 🎯`,timestamp:new Date,coinContext:e};i([t])}},[e]);const v=async()=>{if(!r.trim()&&!y||u)return;const a={id:Date.now().toString(),role:"user",content:r,timestamp:new Date,coinContext:e,imageData:y};i(e=>[...e,a]),ae.saveInteraction(a),n("");const l=y;b(""),p(!0);try{const r=await te.sendMessage([...s,a],e,l||t),n={id:(Date.now()+1).toString(),role:"assistant",content:r,timestamp:new Date,coinContext:e};i(e=>[...e,n]),ae.saveInteraction(n)}catch(o){console.error("Chat hatası:",o);const e={id:(Date.now()+1).toString(),role:"assistant",content:`❌ Üzgünüm, bir hata oluştu: ${o instanceof Error?o.message:"Bilinmeyen hata"}. API anahtarınızı kontrol edin.`,timestamp:new Date};i(t=>[...t,e]),l&&b(l)}finally{p(!1)}},k=(e,t)=>{ae.saveFeedback(e,t),i(a=>a.map(a=>a.id===e?{...a,feedback:t}:a))};return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg h-[600px] flex flex-col",children:[Z.jsxs("div",{className:"flex items-center space-x-2 p-4 border-b bg-gradient-to-r from-blue-50 to-purple-50 rounded-t-lg",children:[Z.jsx(l,{className:"w-5 h-5 text-blue-600"}),Z.jsx("h3",{className:"font-semibold text-gray-800",children:"AI Trading Koçu"}),e&&Z.jsxs("span",{className:"text-sm text-gray-600",children:["• ",e.symbol.toUpperCase()]})]}),Z.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===s.length&&Z.jsxs("div",{className:"text-center text-gray-500 py-8",children:[Z.jsx(o,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),Z.jsx("p",{children:"Bir coin seç ve benimle konuşmaya başla!"}),Z.jsx("p",{className:"text-sm mt-1",children:"Price action, risk yönetimi, teknik analiz..."})]}),s.map(e=>Z.jsx("div",{className:"flex "+("user"===e.role?"justify-end":"justify-start"),children:Z.jsx("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg "+("user"===e.role?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"),children:Z.jsxs("div",{className:"flex items-start space-x-2",children:["assistant"===e.role&&Z.jsx(o,{className:"w-4 h-4 mt-0.5 text-blue-600"}),"user"===e.role&&Z.jsx(c,{className:"w-4 h-4 mt-0.5 text-white"}),Z.jsxs("div",{className:"flex-1",children:[Z.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),Z.jsx("p",{className:"text-xs mt-1 "+("user"===e.role?"text-blue-100":"text-gray-500"),children:e.timestamp.toLocaleTimeString()}),"user"===e.role&&e.imageData&&Z.jsx("div",{className:"mt-2",children:Z.jsx("img",{src:e.imageData,alt:"Yüklenen resim",className:"max-w-48 rounded-lg border"})}),"assistant"===e.role&&Z.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[Z.jsx("button",{onClick:()=>k(e.id,"helpful"),className:"p-1 rounded "+("helpful"===e.feedback?"bg-green-100 text-green-600":"text-gray-400 hover:text-green-600"),children:Z.jsx(d,{className:"w-3 h-3"})}),Z.jsx("button",{onClick:()=>k(e.id,"not_helpful"),className:"p-1 rounded "+("not_helpful"===e.feedback?"bg-red-100 text-red-600":"text-gray-400 hover:text-red-600"),children:Z.jsx(m,{className:"w-3 h-3"})})]})]})]})})},e.id)),u&&Z.jsx("div",{className:"flex justify-start",children:Z.jsx("div",{className:"bg-gray-100 rounded-lg px-4 py-2",children:Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx(o,{className:"w-4 h-4 text-blue-600"}),Z.jsxs("div",{className:"flex space-x-1",children:[Z.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),Z.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),Z.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),Z.jsx("div",{ref:f})]}),Z.jsxs("div",{className:"border-t p-4",children:[y&&Z.jsxs("div",{className:"mb-3 relative inline-block",children:[Z.jsx("img",{src:y,alt:"Yüklenecek resim",className:"max-w-32 max-h-32 rounded-lg border object-cover"}),Z.jsx("button",{onClick:()=>b(""),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:Z.jsx(g,{className:"w-3 h-3"})})]}),Z.jsxs("div",{className:"flex space-x-2",children:[Z.jsxs("label",{className:"flex items-center justify-center w-10 h-10 bg-gray-100 hover:bg-gray-200 rounded-lg cursor-pointer transition-colors",children:[Z.jsx(h,{className:"w-4 h-4 text-gray-600"}),Z.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return(null==(t=e.target.files)?void 0:t[0])&&(e=>{if(e.type.startsWith("image/")){const t=new FileReader;t.onload=e=>{var t;const a=null==(t=e.target)?void 0:t.result;b(a)},t.readAsDataURL(e)}else alert("Lütfen sadece resim dosyası yükleyin!")})(e.target.files[0])},className:"hidden"})]}),Z.jsx("input",{type:"text",value:r,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:e?`${e.symbol.toUpperCase()} hakkında sor... ${y?"(📷 Resim eklendi)":""}`:"Önce bir coin seç...",disabled:!e||u,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"}),Z.jsx("button",{onClick:v,disabled:!r.trim()&&!y||!e||u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:Z.jsx(x,{className:"w-4 h-4"})})]}),Z.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"📷 Grafik resmi yükleyip analiz isteyebilirsiniz"})]})]})},ie=({onImageUpload:e,uploadedImage:t})=>{const[s,i]=a.useState(!1),r=t=>{if(t.type.startsWith("image/")){const a=new FileReader;a.onload=t=>{var a;const s=null==(a=t.target)?void 0:a.result;e(s)},a.readAsDataURL(t)}};return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Grafik Yükle (Opsiyonel)"}),t?Z.jsxs("div",{className:"relative",children:[Z.jsx("img",{src:t,alt:"Yüklenen grafik",className:"w-full max-h-64 object-contain rounded-lg border"}),Z.jsx("button",{onClick:()=>e(""),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:Z.jsx(g,{className:"w-4 h-4"})})]}):Z.jsx("div",{onDrop:e=>{e.preventDefault(),i(!1);const t=Array.from(e.dataTransfer.files);t.length>0&&r(t[0])},onDragOver:e=>{e.preventDefault(),i(!0)},onDragLeave:()=>i(!1),className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(s?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),children:Z.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[Z.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:Z.jsx(h,{className:"w-6 h-6 text-gray-400"})}),Z.jsxs("div",{children:[Z.jsx("p",{className:"text-gray-600 mb-2",children:"Grafik görüntüsünü buraya sürükleyin veya"}),Z.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[Z.jsx(u,{className:"w-4 h-4 mr-2"}),"Dosya Seç",Z.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files;t&&t.length>0&&r(t[0])},className:"hidden"})]})]}),Z.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF formatları desteklenir"})]})})]})},re=()=>{var e,t;const[s,i]=a.useState(null),[n,l]=a.useState(!0);a.useEffect(()=>{o()},[]);const o=async()=>{try{l(!0);const e=await ae.getAnalytics();i(e)}catch(e){console.error("Analytics yükleme hatası:",e)}finally{l(!1)}};return n?Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"animate-pulse",children:[Z.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),Z.jsxs("div",{className:"space-y-3",children:[Z.jsx("div",{className:"h-4 bg-gray-200 rounded"}),Z.jsx("div",{className:"h-4 bg-gray-200 rounded"}),Z.jsx("div",{className:"h-4 bg-gray-200 rounded"})]})]})}):Z.jsxs("div",{className:"space-y-6",children:[Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Z.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center",children:Z.jsx(p,{className:"w-6 h-6 text-white"})}),Z.jsxs("div",{children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenme Merkezi"}),Z.jsx("p",{className:"text-gray-600",children:"AI destekli kişiselleştirilmiş trading eğitimi"})]})]}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[Z.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-blue-600 text-sm font-medium",children:"Toplam Etkileşim"}),Z.jsx("p",{className:"text-2xl font-bold text-blue-800",children:(null==s?void 0:s.totalInteractions)||0})]}),Z.jsx(y,{className:"w-8 h-8 text-blue-600"})]})}),Z.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-green-600 text-sm font-medium",children:"Öğrenilen Konu"}),Z.jsx("p",{className:"text-2xl font-bold text-green-800",children:(null==s?void 0:s.topicsLearned)||0})]}),Z.jsx(b,{className:"w-8 h-8 text-green-600"})]})}),Z.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-purple-600 text-sm font-medium",children:"Başarı Oranı"}),Z.jsxs("p",{className:"text-2xl font-bold text-purple-800",children:[(null==s?void 0:s.successRate)||0,"%"]})]}),Z.jsx(f,{className:"w-8 h-8 text-purple-600"})]})}),Z.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-orange-600 text-sm font-medium",children:"Aktif Gün"}),Z.jsx("p",{className:"text-2xl font-bold text-orange-800",children:(null==s?void 0:s.activeDays)||0})]}),Z.jsx(r,{className:"w-8 h-8 text-orange-600"})]})})]})]}),Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[Z.jsx(v,{className:"w-5 h-5 mr-2 text-blue-600"}),"Öğrenme İlerlemesi"]}),Z.jsx("div",{className:"space-y-4",children:(null==(e=null==s?void 0:s.learningProgress)?void 0:e.map((e,t)=>Z.jsxs("div",{className:"space-y-2",children:[Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.name}),Z.jsxs("span",{className:"text-sm text-gray-500",children:[e.progress,"%"]})]}),Z.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:Z.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${e.progress}%`}})})]},t)))||Z.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Z.jsx(p,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Z.jsx("p",{children:"Henüz öğrenme verisi yok"}),Z.jsx("p",{className:"text-sm",children:"Sohbet sekmesinde sorular sorarak başlayın!"})]})})]}),Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Öneriler"}),Z.jsx("div",{className:"space-y-3",children:(null==(t=null==s?void 0:s.recommendations)?void 0:t.map((e,t)=>Z.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 rounded-lg",children:[Z.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2 flex-shrink-0"}),Z.jsx("p",{className:"text-sm text-gray-700",children:e})]},t)))||Z.jsx("div",{className:"text-center py-4 text-gray-500",children:Z.jsx("p",{children:"Daha fazla etkileşim sonrası öneriler görünecek"})})})]})]})};const ne=new class{constructor(){t(this,"trainingData",[])}async saveTrainingData(e){try{this.trainingData.push({...e,id:Date.now().toString(),timestamp:new Date}),localStorage.setItem("patternTrainingData",JSON.stringify(this.trainingData))}catch(t){throw console.error("Error saving training data:",t),t}}getTrainingData(){try{const e=localStorage.getItem("patternTrainingData");return e&&(this.trainingData=JSON.parse(e)),this.trainingData}catch(e){return console.error("Error loading training data:",e),[]}}async analyzePattern(e){try{return{trend:"bullish",confidence:"medium",formations:[{name:"Bull Flag",description:"Bullish continuation pattern detected",confidence:"medium",targetPrice:45e3,breakoutLevel:42e3}],supportLevels:[4e4,38e3],resistanceLevels:[44e3,46e3],riskAnalysis:{stopLoss:39e3,targetPrice:45e3,riskRewardRatio:2.5,positionSize:"2%"},coachComment:"Pattern shows potential bullish continuation. Wait for breakout confirmation."}}catch(t){throw console.error("Error analyzing pattern:",t),t}}async getPatternStatistics(){try{const e=this.getTrainingData(),t={totalPatterns:e.length,patternTypes:{},accuracyRate:0,recentActivity:e.slice(-10)};e.forEach(e=>{const a=e.patternType||"Unknown";t.patternTypes[a]=(t.patternTypes[a]||0)+1});const a=e.filter(e=>"correct"===e.outcome||"successful"===e.outcome).length;return t.accuracyRate=e.length>0?a/e.length*100:0,t}catch(e){return console.error("Error getting pattern statistics:",e),{totalPatterns:0,patternTypes:{},accuracyRate:0,recentActivity:[]}}}};const le=new class{constructor(){t(this,"apiKey",ee.openaiApiKey),t(this,"baseUrl",ee.baseUrl)}async convertPDFToBase64(e){return new Promise((t,a)=>{const s=new FileReader;s.onload=()=>{const e=s.result;t(e)},s.onerror=a,s.readAsDataURL(e)})}async analyzePDF(e,t){try{if(!e||!e.startsWith("data:"))throw new Error("Geçersiz PDF formatı");const a=this.buildPDFPrompt(t),s=[{role:"system",content:this.getSystemPrompt()},{role:"user",content:a+"\n\nNot: PDF dosyası yüklendi ancak görsel analiz şu anda desteklenmiyor. Lütfen PDF içeriğini metin olarak analiz edin."}],i=await fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4",messages:s,temperature:.2,max_tokens:3e3})});if(!i.ok)throw new Error("PDF analiz hatası");const r=await i.json();return this.parsePDFAnalysis(r.choices[0].message.content,t)}catch(a){throw console.error("PDF analiz servisi hatası:",a),a}}async analyzePDFSimple(e,t){try{const a=e.name,s=e.size;return{...this.generateMockAnalysis(a,t),fileName:a,fileSize:s,analysisType:t,analyzedAt:new Date,method:"simplified"}}catch(a){throw console.error("Basit PDF analiz hatası:",a),new Error("PDF dosyası okunamadı")}}generateMockAnalysis(e,t){const a={fileName:e,success:!0,message:"PDF başarıyla analiz edildi"};switch(t){case"patterns":return{...a,detectedPatterns:[{name:"Head and Shoulders",type:"bearish",category:"chart",reliability:"high",description:"PDF içeriğinden tespit edilen baş-omuz formasyonu",context:e},{name:"Cup and Handle",type:"bullish",category:"chart",reliability:"medium",description:"Kulp formasyonu tespit edildi",context:e}],summary:"PDF içeriğinden 2 pattern tespit edildi",educationalValue:"Yüksek - Eğitim amaçlı kullanılabilir"};case"education":return{...a,educationalContent:[{topic:"Teknik Analiz Temelleri",level:"intermediate",content:"PDF içeriğinden çıkarılan eğitim materyali",examples:["Grafik okuma","Pattern tanıma"],keyPoints:["Destek-direnç","Trend analizi"]}],overallLevel:"Orta seviye",recommendedUse:"Eğitim amaçlı kullanım önerilir"};case"strategy":return{...a,strategies:[{name:"Trend Takip Stratejisi",type:"swing",entryRules:["Trend onayı","Hacim artışı"],exitRules:["Hedef seviye","Stop loss"],riskManagement:"Pozisyon büyüklüğü %2",timeframe:"4h-1d"}],overallApproach:"Konservatif yaklaşım önerilir"};default:return a}}getSystemPrompt(){return"\n    Sen dünya çapında tanınmış bir teknik analiz uzmanısın ve PDF dokümanlarından trading bilgilerini çıkarma konusunda uzmansın.\n\n    🎯 UZMANLIK ALANLARIN:\n    - PDF'deki grafik ve chart'ları analiz etme\n    - Trading pattern'lerini tespit etme\n    - Eğitim materyallerinden bilgi çıkarma\n    - Strateji dokümanlarını anlama\n    - Candlestick ve chart pattern'leri\n\n    📋 GÖREVLERİN:\n    1. PDF'deki tüm grafikleri incele\n    2. Pattern'leri tespit et ve kategorize et\n    3. Metin içindeki önemli bilgileri çıkar\n    4. Eğitim verisi olarak kullanılabilir bilgileri organize et\n    5. JSON formatında yapılandırılmış çıktı ver\n\n    💡 DİKKAT EDİLECEKLER:\n    - Her sayfayı dikkatli incele\n    - Grafiklerdeki pattern'leri detaylı analiz et\n    - Metin ve grafik arasındaki bağlantıları kur\n    - Eğitim verisi kalitesini değerlendir\n    "}buildPDFPrompt(e){const t=`\n    Bu PDF dokümanını analiz et ve içindeki trading bilgilerini çıkar.\n    \n    Analiz Türü: ${e}\n    `;switch(e){case"patterns":return t+'\n        🎯 PATTERN ANALİZİ:\n        - Tüm grafiklerdeki pattern\'leri tespit et\n        - Her pattern için: isim, tür, güvenilirlik, açıklama\n        - Candlestick formasyonlarını belirle\n        - Chart pattern\'lerini kategorize et\n        \n        JSON Çıktı Formatı:\n        {\n          "detectedPatterns": [\n            {\n              "name": "Pattern adı",\n              "type": "bullish/bearish/neutral",\n              "category": "candlestick/chart",\n              "reliability": "low/medium/high",\n              "description": "Detaylı açıklama",\n              "pageNumber": sayfa_no,\n              "context": "Çevresel bilgi"\n            }\n          ],\n          "summary": "Genel özet",\n          "educationalValue": "Eğitim değeri"\n        }\n        ';case"education":return t+'\n        📚 EĞİTİM MATERYALİ ANALİZİ:\n        - Öğretici içerikleri tespit et\n        - Örnekleri ve açıklamaları çıkar\n        - Eğitim seviyesini belirle\n        - Pratik uygulamaları not et\n        \n        JSON Çıktı Formatı:\n        {\n          "educationalContent": [\n            {\n              "topic": "Konu başlığı",\n              "level": "beginner/intermediate/advanced",\n              "content": "İçerik özeti",\n              "examples": ["örnek1", "örnek2"],\n              "keyPoints": ["nokta1", "nokta2"]\n            }\n          ],\n          "overallLevel": "Genel seviye",\n          "recommendedUse": "Kullanım önerisi"\n        }\n        ';case"strategy":return t+'\n        📈 STRATEJİ ANALİZİ:\n        - Trading stratejilerini tespit et\n        - Giriş/çıkış kurallarını çıkar\n        - Risk yönetimi bilgilerini not et\n        - Performans metriklerini belirle\n        \n        JSON Çıktı Formatı:\n        {\n          "strategies": [\n            {\n              "name": "Strateji adı",\n              "type": "scalping/swing/position",\n              "entryRules": ["kural1", "kural2"],\n              "exitRules": ["kural1", "kural2"],\n              "riskManagement": "Risk yönetimi",\n              "timeframe": "Zaman dilimi"\n            }\n          ],\n          "overallApproach": "Genel yaklaşım"\n        }\n        ';default:return t}}parsePDFAnalysis(e,t){try{const t=e.match(/\{[\s\S]*\}/);if(t)return JSON.parse(t[0])}catch(a){console.error("JSON parse hatası:",a)}return{error:"Analiz sonucu parse edilemedi",rawText:e,analysisType:t}}async savePDFLearningData(e,t){try{const a={id:Date.now().toString(),source:"pdf",fileName:t,analysisResult:e,createdAt:new Date,type:"pdf_analysis"},s=JSON.parse(localStorage.getItem("pdf_learning_data")||"[]");s.push(a),localStorage.setItem("pdf_learning_data",JSON.stringify(s))}catch(a){console.error("PDF öğrenme verisi kaydedilemedi:",a)}}getPDFLearningData(){try{return JSON.parse(localStorage.getItem("pdf_learning_data")||"[]")}catch(e){return console.error("PDF öğrenme verisi yüklenemedi:",e),[]}}},oe=({onAnalysisComplete:e})=>{const[t,s]=a.useState(null),[i,n]=a.useState("patterns"),[l,o]=a.useState(!1),[c,d]=a.useState(null),[m,h]=a.useState(!1),x=e=>{"application/pdf"===e.type?(s(e),d(null)):alert("Lütfen sadece PDF dosyası yükleyin!")},y=[{value:"patterns",label:"Pattern Analizi",icon:r,description:"Grafiklerdeki formasyonları tespit et",color:"text-blue-600"},{value:"education",label:"Eğitim İçeriği",icon:b,description:"Öğretici materyalleri çıkar",color:"text-green-600"},{value:"strategy",label:"Strateji Analizi",icon:j,description:"Trading stratejilerini belirle",color:"text-purple-600"}];return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Z.jsx(k,{className:"w-6 h-6 text-red-600"}),Z.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"PDF Analizi"}),Z.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"AI Öğrenme"})]}),Z.jsxs("div",{className:"mb-6",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Analiz Türü Seçin"}),Z.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:y.map(e=>{const t=e.icon;return Z.jsxs("button",{onClick:()=>n(e.value),className:"p-3 rounded-lg border-2 transition-all "+(i===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Z.jsx(t,{className:`w-4 h-4 ${e.color}`}),Z.jsx("span",{className:"font-medium text-gray-800",children:e.label})]}),Z.jsx("p",{className:"text-xs text-gray-600",children:e.description})]},e.value)})})]}),t?Z.jsx("div",{className:"mb-6",children:Z.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[Z.jsx(k,{className:"w-8 h-8 text-red-600"}),Z.jsxs("div",{children:[Z.jsx("div",{className:"font-medium text-gray-800",children:t.name}),Z.jsxs("div",{className:"text-sm text-gray-500",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]}),Z.jsx("button",{onClick:()=>s(null),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:Z.jsx(g,{className:"w-5 h-5"})})]})}):Z.jsx("div",{onDrop:e=>{e.preventDefault(),h(!1);const t=Array.from(e.dataTransfer.files);t.length>0&&x(t[0])},onDragOver:e=>{e.preventDefault(),h(!0)},onDragLeave:()=>h(!1),className:"mb-6 border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(m?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),children:Z.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[Z.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:Z.jsx(k,{className:"w-6 h-6 text-red-600"})}),Z.jsxs("div",{children:[Z.jsx("p",{className:"text-gray-600 mb-2",children:"PDF dosyasını buraya sürükleyin veya"}),Z.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 cursor-pointer transition-colors",children:[Z.jsx(u,{className:"w-4 h-4 mr-2"}),"PDF Seç",Z.jsx("input",{type:"file",accept:".pdf",onChange:e=>{const t=e.target.files;t&&t.length>0&&x(t[0])},className:"hidden"})]})]}),Z.jsx("p",{className:"text-xs text-gray-500",children:"Trading kitapları, analiz raporları, eğitim materyalleri"})]})}),Z.jsx("button",{onClick:async()=>{if(t)try{o(!0);const a=await le.analyzePDFSimple(t,i);d(a),await le.savePDFLearningData(a,t.name),e&&e(a),alert(`PDF analizi tamamlandı! ${"patterns"===i?"Patternler":"education"===i?"Eğitim içeriği":"Stratejiler"} tespit edildi.`)}catch(a){console.error("PDF analiz hatası:",a),alert(`PDF analizi hatası: ${a instanceof Error?a.message:"Bilinmeyen hata"}. Lütfen farklı bir PDF deneyin.`)}finally{o(!1)}},disabled:!t||l,className:"w-full py-3 px-4 rounded-lg font-semibold transition-colors flex items-center justify-center space-x-2 "+(t&&!l?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:l?Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Z.jsx("span",{children:"PDF Analiz Ediliyor..."})]}):Z.jsxs(Z.Fragment,{children:[Z.jsx(p,{className:"w-4 h-4"}),Z.jsx("span",{children:"PDF'i Analiz Et ve Öğret"})]})}),c&&Z.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[Z.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:"✅ Analiz Tamamlandı!"}),"patterns"===i&&c.detectedPatterns&&Z.jsxs("div",{children:[Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.detectedPatterns.length," pattern tespit edildi"]}),Z.jsx("div",{className:"space-y-1",children:c.detectedPatterns.slice(0,3).map((e,t)=>Z.jsxs("div",{className:"text-xs bg-white p-2 rounded",children:[Z.jsx("strong",{children:e.name})," - ",e.description]},t))})]}),"education"===i&&c.educationalContent&&Z.jsx("div",{children:Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.educationalContent.length," eğitim konusu çıkarıldı"]})}),"strategy"===i&&c.strategies&&Z.jsx("div",{children:Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.strategies.length," strateji tespit edildi"]})}),Z.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Bu bilgiler AI'nın öğrenme veritabanına eklendi!"})]}),Z.jsx("div",{className:"mt-4 text-center",children:Z.jsxs("p",{className:"text-xs text-gray-500",children:["Toplam ",le.getPDFLearningData().length," PDF analiz edildi"]})})]})};const ce=new class{constructor(){t(this,"apiKey",ee.openaiApiKey),t(this,"baseUrl",ee.baseUrl)}async analyzeWebPage(e,t){try{const a=this.validateAndCleanUrl(e),s=this.buildWebPrompt(a,t),i=[{role:"system",content:this.getSystemPrompt()},{role:"user",content:s}],r=await fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4",messages:i,temperature:.2,max_tokens:3e3})});if(!r.ok)throw new Error("Web analiz hatası");const n=await r.json();return this.parseWebAnalysis(n.choices[0].message.content,t,a)}catch(a){throw console.error("Web analiz servisi hatası:",a),a}}validateAndCleanUrl(e){try{e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e);return new URL(e).href}catch(t){throw new Error("Geçersiz URL formatı")}}getSystemPrompt(){return"\n    Sen dünya çapında tanınmış bir web scraping ve trading analiz uzmanısın. \n    Verilen URL'deki içeriği analiz edip trading bilgilerini çıkarma konusunda uzmansın.\n\n    🎯 UZMANLIK ALANLARIN:\n    - Web sayfalarındaki grafik ve chart'ları analiz etme\n    - Trading pattern'lerini tespit etme\n    - Haber ve analiz içeriklerini değerlendirme\n    - Eğitim materyallerinden bilgi çıkarma\n    - Strateji ve sinyal içeriklerini anlama\n\n    📋 GÖREVLERİN:\n    1. URL'deki tüm trading ile ilgili içeriği incele\n    2. Grafikleri ve pattern'leri tespit et\n    3. Önemli bilgileri kategorize et\n    4. Eğitim değeri olan içerikleri belirle\n    5. JSON formatında yapılandırılmış çıktı ver\n\n    💡 DİKKAT EDİLECEKLER:\n    - Sadece trading ile ilgili içerikleri analiz et\n    - Grafiklerdeki pattern'leri detaylı incele\n    - Güvenilir kaynaklardan gelen bilgileri öncelendir\n    - Spam veya yanıltıcı içerikleri filtrele\n    "}buildWebPrompt(e,t){const a=`\n    Bu web sayfasını analiz et ve trading bilgilerini çıkar: ${e}\n    \n    Analiz Türü: ${t}\n    `;switch(t){case"patterns":return a+`\n        🎯 PATTERN ANALİZİ:\n        - Sayfadaki tüm grafikleri incele\n        - Pattern'leri tespit et ve kategorize et\n        - Candlestick ve chart formasyonlarını belirle\n        - Teknik analiz içeriklerini çıkar\n        \n        JSON Çıktı Formatı:\n        {\n          "url": "${e}",\n          "title": "Sayfa başlığı",\n          "detectedPatterns": [\n            {\n              "name": "Pattern adı",\n              "type": "bullish/bearish/neutral",\n              "category": "candlestick/chart",\n              "reliability": "low/medium/high",\n              "description": "Detaylı açıklama",\n              "context": "Çevresel bilgi"\n            }\n          ],\n          "technicalAnalysis": "Teknik analiz özeti",\n          "educationalValue": "Eğitim değeri",\n          "sourceReliability": "Kaynak güvenilirliği"\n        }\n        `;case"education":return a+`\n        📚 EĞİTİM İÇERİĞİ ANALİZİ:\n        - Öğretici içerikleri tespit et\n        - Trading eğitimi materyallerini çıkar\n        - Örnekleri ve açıklamaları belirle\n        - Eğitim seviyesini değerlendir\n        \n        JSON Çıktı Formatı:\n        {\n          "url": "${e}",\n          "educationalContent": [\n            {\n              "topic": "Konu başlığı",\n              "level": "beginner/intermediate/advanced",\n              "content": "İçerik özeti",\n              "examples": ["örnek1", "örnek2"],\n              "keyPoints": ["nokta1", "nokta2"]\n            }\n          ],\n          "overallLevel": "Genel seviye",\n          "recommendedUse": "Kullanım önerisi"\n        }\n        `;case"strategy":return a+`\n        📈 STRATEJİ ANALİZİ:\n        - Trading stratejilerini tespit et\n        - Giriş/çıkış sinyallerini çıkar\n        - Risk yönetimi bilgilerini not et\n        - Performans verilerini belirle\n        \n        JSON Çıktı Formatı:\n        {\n          "url": "${e}",\n          "strategies": [\n            {\n              "name": "Strateji adı",\n              "type": "scalping/swing/position",\n              "signals": ["sinyal1", "sinyal2"],\n              "riskManagement": "Risk yönetimi",\n              "performance": "Performans bilgisi"\n            }\n          ],\n          "marketOutlook": "Market görünümü"\n        }\n        `;case"news":return a+`\n        📰 HABER VE ANALİZ:\n        - Trading haberlerini analiz et\n        - Market etkilerini değerlendir\n        - Önemli gelişmeleri tespit et\n        - Fiyat etkilerini öngör\n        \n        JSON Çıktı Formatı:\n        {\n          "url": "${e}",\n          "newsAnalysis": [\n            {\n              "headline": "Haber başlığı",\n              "impact": "high/medium/low",\n              "marketEffect": "bullish/bearish/neutral",\n              "affectedAssets": ["BTC", "ETH"],\n              "summary": "Haber özeti"\n            }\n          ],\n          "overallSentiment": "Genel duygu durumu"\n        }\n        `;default:return a}}parseWebAnalysis(e,t,a){try{const s=e.match(/\{[\s\S]*\}/);if(s){return{...JSON.parse(s[0]),analysisType:t,analyzedAt:new Date,url:a}}}catch(s){console.error("JSON parse hatası:",s)}return{error:"Analiz sonucu parse edilemedi",rawText:e,analysisType:t,url:a,analyzedAt:new Date}}async saveWebLearningData(e){try{const t={id:Date.now().toString(),source:"web",url:e.url,analysisResult:e,createdAt:new Date,type:"web_analysis"},a=JSON.parse(localStorage.getItem("web_learning_data")||"[]");a.push(t),a.length>50&&a.splice(0,a.length-50),localStorage.setItem("web_learning_data",JSON.stringify(a))}catch(t){console.error("Web öğrenme verisi kaydedilemedi:",t)}}getWebLearningData(){try{return JSON.parse(localStorage.getItem("web_learning_data")||"[]")}catch(e){return console.error("Web öğrenme verisi yüklenemedi:",e),[]}}getPopularTradingSites(){return[{category:"Teknik Analiz",sites:[{name:"TradingView",url:"https://tradingview.com",description:"Grafik analizi ve pattern'ler"},{name:"Investing.com",url:"https://investing.com",description:"Teknik analiz ve haberler"},{name:"CoinMarketCap",url:"https://coinmarketcap.com",description:"Kripto analizi"}]},{category:"Eğitim",sites:[{name:"Babypips",url:"https://babypips.com",description:"Forex eğitimi"},{name:"Investopedia",url:"https://investopedia.com",description:"Trading eğitimi"},{name:"CoinDesk",url:"https://coindesk.com",description:"Kripto eğitimi"}]},{category:"Haberler",sites:[{name:"CoinTelegraph",url:"https://cointelegraph.com",description:"Kripto haberleri"},{name:"Bloomberg",url:"https://bloomberg.com",description:"Finansal haberler"},{name:"Reuters",url:"https://reuters.com",description:"Piyasa haberleri"}]}]}},de=({onAnalysisComplete:e})=>{const[t,s]=a.useState(""),[i,n]=a.useState("patterns"),[l,o]=a.useState(!1),[c,d]=a.useState(null),m=e=>{switch(e){case"patterns":return"Pattern";case"education":return"Eğitim";case"strategy":return"Strateji";case"news":return"Haber";default:return"Analiz"}},g=[{value:"patterns",label:"Pattern Analizi",icon:r,description:"Grafiklerdeki formasyonları tespit et",color:"text-blue-600"},{value:"education",label:"Eğitim İçeriği",icon:b,description:"Öğretici materyalleri çıkar",color:"text-green-600"},{value:"strategy",label:"Strateji Analizi",icon:j,description:"Trading stratejilerini belirle",color:"text-purple-600"},{value:"news",label:"Haber Analizi",icon:D,description:"Market haberlerini değerlendir",color:"text-orange-600"}],h=ce.getPopularTradingSites();return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Z.jsx(N,{className:"w-6 h-6 text-blue-600"}),Z.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Web Link Analizi"}),Z.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:"AI Öğrenme"})]}),Z.jsxs("div",{className:"mb-6",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Analiz Türü Seçin"}),Z.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:g.map(e=>{const t=e.icon;return Z.jsx("button",{onClick:()=>n(e.value),className:"p-3 rounded-lg border-2 transition-all "+(i===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:Z.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[Z.jsx(t,{className:`w-4 h-4 ${e.color}`}),Z.jsx("span",{className:"text-xs font-medium text-gray-800",children:e.label})]})},e.value)})})]}),Z.jsxs("div",{className:"mb-6",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Web Sitesi URL'si"}),Z.jsxs("div",{className:"flex space-x-2",children:[Z.jsxs("div",{className:"flex-1 relative",children:[Z.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Z.jsx("input",{type:"url",value:t,onChange:e=>s(e.target.value),placeholder:"https://tradingview.com/chart/BTCUSD",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),Z.jsx("button",{onClick:async()=>{if(t.trim())try{o(!0);const a=await ce.analyzeWebPage(t,i);d(a),await ce.saveWebLearningData(a),e&&e(a),alert(`Web analizi tamamlandı! ${m(i)} bilgileri çıkarıldı.`)}catch(a){console.error("Web analiz hatası:",a),alert("Web analizi sırasında bir hata oluştu. URL'yi kontrol edin ve tekrar deneyin.")}finally{o(!1)}else alert("Lütfen bir URL girin!")},disabled:!t.trim()||l,className:"px-6 py-3 rounded-lg font-semibold transition-colors flex items-center space-x-2 "+(t.trim()&&!l?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:l?Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Z.jsx("span",{children:"Analiz..."})]}):Z.jsxs(Z.Fragment,{children:[Z.jsx(p,{className:"w-4 h-4"}),Z.jsx("span",{children:"Analiz Et"})]})})]})]}),Z.jsxs("div",{className:"mb-6",children:[Z.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Popüler Trading Siteleri"}),Z.jsx("div",{className:"space-y-3",children:h.map(e=>Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:e.category}),Z.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:e.sites.map(e=>Z.jsx("button",{onClick:()=>s(e.url),className:"p-2 text-left border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("div",{className:"text-sm font-medium text-gray-800",children:e.name}),Z.jsx("div",{className:"text-xs text-gray-500",children:e.description})]}),Z.jsx(w,{className:"w-3 h-3 text-gray-400"})]})},e.name))})]},e.category))})]}),c&&Z.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[Z.jsxs("h3",{className:"font-semibold text-green-800 mb-2 flex items-center",children:["✅ Web Analizi Tamamlandı!",Z.jsx(w,{className:"w-4 h-4 ml-2"})]}),Z.jsxs("div",{className:"text-sm text-green-700 mb-2",children:[Z.jsx("strong",{children:"Kaynak:"})," ",c.title||c.url]}),"patterns"===i&&c.detectedPatterns&&Z.jsxs("div",{children:[Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.detectedPatterns.length," pattern tespit edildi"]}),Z.jsx("div",{className:"space-y-1",children:c.detectedPatterns.slice(0,3).map((e,t)=>Z.jsxs("div",{className:"text-xs bg-white p-2 rounded",children:[Z.jsx("strong",{children:e.name})," - ",e.description]},t))})]}),"education"===i&&c.educationalContent&&Z.jsx("div",{children:Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.educationalContent.length," eğitim konusu çıkarıldı"]})}),"strategy"===i&&c.strategies&&Z.jsx("div",{children:Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.strategies.length," strateji tespit edildi"]})}),"news"===i&&c.newsAnalysis&&Z.jsx("div",{children:Z.jsxs("p",{className:"text-sm text-green-700 mb-2",children:[c.newsAnalysis.length," haber analiz edildi"]})}),Z.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Bu bilgiler AI'nın öğrenme veritabanına eklendi!"})]}),Z.jsx("div",{className:"mt-4 text-center",children:Z.jsxs("p",{className:"text-xs text-gray-500",children:["Toplam ",ce.getWebLearningData().length," web sitesi analiz edildi"]})})]})},me=()=>{const[e,t]=a.useState(""),[s,i]=a.useState(""),[n,l]=a.useState("successful"),[o,c]=a.useState("1h"),[d,m]=a.useState("trending"),[g,h]=a.useState(""),[x,y]=a.useState(""),[f,v]=a.useState(""),[k,N]=a.useState("manual"),S=ne.getTrainingData().length;return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Z.jsx(p,{className:"w-6 h-6 text-purple-600"}),Z.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"AI Eğitim Merkezi"}),Z.jsxs("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:[S," eğitim verisi"]})]}),Z.jsxs("div",{className:"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg",children:[Z.jsx("button",{onClick:()=>N("manual"),className:"flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors "+("manual"===k?"bg-white text-purple-700 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"📊 Manuel Eğitim"}),Z.jsx("button",{onClick:()=>N("pdf"),className:"flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors "+("pdf"===k?"bg-white text-purple-700 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"📄 PDF Analizi"}),Z.jsx("button",{onClick:()=>N("web"),className:"flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors "+("web"===k?"bg-white text-purple-700 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"🌐 Web Link"})]}),"pdf"===k?Z.jsx(oe,{onAnalysisComplete:e=>{console.log("PDF analizi tamamlandı:",e)}}):"web"===k?Z.jsx(de,{onAnalysisComplete:e=>{console.log("Web analizi tamamlandı:",e)}}):Z.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Z.jsxs("div",{className:"space-y-4",children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grafik Resmi Yükle"}),e?Z.jsxs("div",{className:"relative",children:[Z.jsx("img",{src:e,alt:"Eğitim grafiği",className:"w-full max-h-48 object-contain rounded-lg border"}),Z.jsx("button",{onClick:()=>t(""),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:"×"})]}):Z.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[Z.jsx(u,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),Z.jsxs("label",{className:"cursor-pointer",children:[Z.jsx("span",{className:"text-blue-600 hover:text-blue-700",children:"Grafik seç"}),Z.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var a;return(null==(a=e.target.files)?void 0:a[0])&&(e=>{if(e.type.startsWith("image/")){const a=new FileReader;a.onload=e=>{var a;const s=null==(a=e.target)?void 0:a.result;t(s)},a.readAsDataURL(e)}})(e.target.files[0])},className:"hidden"})]})]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pattern Türü"}),Z.jsxs("select",{value:s,onChange:e=>i(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",children:[Z.jsx("option",{value:"",children:"Pattern seçin..."}),["Head and Shoulders","Inverse Head and Shoulders","Double Top","Double Bottom","Cup and Handle","Ascending Triangle","Descending Triangle","Symmetrical Triangle","Flag","Pennant","Wedge","Rectangle","Channel","Rounding Bottom","Hammer","Doji","Engulfing","Morning Star","Evening Star","Shooting Star"].map(e=>Z.jsx("option",{value:e,children:e},e))]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pattern Sonucu"}),Z.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"successful",label:"Başarılı",color:"bg-green-100 text-green-800"},{value:"partial",label:"Kısmi",color:"bg-yellow-100 text-yellow-800"},{value:"failed",label:"Başarısız",color:"bg-red-100 text-red-800"}].map(e=>Z.jsx("button",{onClick:()=>l(e.value),className:"p-2 text-sm rounded-lg border transition-colors "+(n===e.value?`${e.color} border-current`:"border-gray-300 hover:border-gray-400"),children:e.label},e.value))})]})]}),Z.jsxs("div",{className:"space-y-4",children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zaman Dilimi"}),Z.jsxs("select",{value:o,onChange:e=>c(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",children:[Z.jsx("option",{value:"1m",children:"1 Dakika"}),Z.jsx("option",{value:"5m",children:"5 Dakika"}),Z.jsx("option",{value:"15m",children:"15 Dakika"}),Z.jsx("option",{value:"1h",children:"1 Saat"}),Z.jsx("option",{value:"4h",children:"4 Saat"}),Z.jsx("option",{value:"1d",children:"1 Gün"})]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Market Durumu"}),Z.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"trending",label:"Trendli"},{value:"ranging",label:"Yatay"},{value:"volatile",label:"Volatil"}].map(e=>Z.jsx("button",{onClick:()=>m(e.value),className:"p-2 text-sm rounded-lg border transition-colors "+(d===e.value?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 hover:border-gray-400"),children:e.label},e.value))})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fiyat Verileri (Opsiyonel)"}),Z.jsx("input",{type:"text",value:x,onChange:e=>y(e.target.value),placeholder:"100, 105, 102, 108... (virgülle ayırın)",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notlar ve Gözlemler"}),Z.jsx("textarea",{value:g,onChange:e=>h(e.target.value),placeholder:"Bu pattern'de dikkat edilmesi gerekenler, hacim durumu, kırılım seviyeleri...",className:"w-full h-20 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 resize-none"})]}),Z.jsxs("button",{onClick:()=>{if(!s||!e)return void alert("Pattern adı ve grafik resmi gerekli!");const a={id:Date.now().toString(),patternName:s,imageData:e,priceData:x?x.split(",").map(e=>parseFloat(e.trim())):[],volumeData:f?f.split(",").map(e=>parseFloat(e.trim())):[],outcome:n,timeframe:o,marketCondition:d,notes:g,createdAt:new Date};ne.saveTrainingData(a),t(""),i(""),h(""),y(""),v(""),alert("Eğitim verisi kaydedildi! AI artık bu pattern'i daha iyi tanıyacak.")},disabled:!s||!e,className:"w-full py-3 px-4 rounded-lg font-semibold transition-colors flex items-center justify-center space-x-2 "+(s&&e?"bg-purple-600 hover:bg-purple-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[Z.jsx(_,{className:"w-4 h-4"}),Z.jsx("span",{children:"Eğitim Verisini Kaydet"})]})]})]}),S>0&&Z.jsxs("div",{className:"mt-6 pt-6 border-t",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Eğitim İstatistikleri"}),Z.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Z.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx(b,{className:"w-4 h-4 text-blue-600"}),Z.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Toplam"})]}),Z.jsx("div",{className:"text-xl font-bold text-blue-900",children:S})]}),Z.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx(r,{className:"w-4 h-4 text-green-600"}),Z.jsx("span",{className:"text-sm font-medium text-green-800",children:"Başarılı"})]}),Z.jsx("div",{className:"text-xl font-bold text-green-900",children:ne.getTrainingData().filter(e=>"successful"===e.outcome).length})]}),Z.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx(j,{className:"w-4 h-4 text-yellow-600"}),Z.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Kısmi"})]}),Z.jsx("div",{className:"text-xl font-bold text-yellow-900",children:ne.getTrainingData().filter(e=>"partial"===e.outcome).length})]}),Z.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx(j,{className:"w-4 h-4 text-red-600"}),Z.jsx("span",{className:"text-sm font-medium text-red-800",children:"Başarısız"})]}),Z.jsx("div",{className:"text-xl font-bold text-red-900",children:ne.getTrainingData().filter(e=>"failed"===e.outcome).length})]})]})]})]})},ge=({coinData:e})=>{const[t,s]=a.useState(!1),[i,l]=a.useState(null);a.useEffect(()=>{e&&o()},[e]);const o=async()=>{try{s(!0);const t={spread:.05,spreadPercentage:.12,bidDepth:125e4,askDepth:118e4,imbalance:5.9,liquidityScore:85,marketSentiment:"bullish",supportWalls:[{price:.98*e.current_price,volume:5e5,percentage:15.2},{price:.95*e.current_price,volume:75e4,percentage:22.8}],resistanceWalls:[{price:1.02*e.current_price,volume:45e4,percentage:13.7},{price:1.05*e.current_price,volume:68e4,percentage:20.6}],depthAnalysis:{totalBidVolume:25e5,totalAskVolume:235e4,avgBidPrice:.995*e.current_price,avgAskPrice:1.005*e.current_price,priceImpact1Percent:.15,priceImpact5Percent:.78}};l(t)}catch(t){console.error("Order book analiz hatası:",t)}finally{s(!1)}};return t?Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"animate-pulse",children:[Z.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),Z.jsx("div",{className:"space-y-3",children:[...Array(4)].map((e,t)=>Z.jsx("div",{className:"h-16 bg-gray-200 rounded"},t))})]})}):i?Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Z.jsx(v,{className:"w-6 h-6 text-blue-600"}),Z.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Order Book Analizi"}),Z.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.symbol.toUpperCase(),")"]})]}),Z.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[Z.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(A,{className:"w-4 h-4 text-blue-600"}),Z.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Spread"})]}),Z.jsxs("div",{className:"text-xl font-bold text-blue-900",children:["$",i.spread.toFixed(2)]}),Z.jsxs("div",{className:"text-xs text-blue-600",children:[i.spreadPercentage.toFixed(3),"%"]})]}),Z.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(r,{className:"w-4 h-4 text-green-600"}),Z.jsx("span",{className:"text-sm font-medium text-green-800",children:"Alış Derinliği"})]}),Z.jsxs("div",{className:"text-xl font-bold text-green-900",children:["$",(i.bidDepth/1e3).toFixed(0),"K"]})]}),Z.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(n,{className:"w-4 h-4 text-red-600"}),Z.jsx("span",{className:"text-sm font-medium text-red-800",children:"Satış Derinliği"})]}),Z.jsxs("div",{className:"text-xl font-bold text-red-900",children:["$",(i.askDepth/1e3).toFixed(0),"K"]})]}),Z.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(T,{className:"w-4 h-4 text-purple-600"}),Z.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Likidite"})]}),Z.jsx("div",{className:"text-xl font-bold text-purple-900",children:i.liquidityScore}),Z.jsx("div",{className:"text-xs text-purple-600",children:i.liquidityScore>80?"Yüksek":i.liquidityScore>60?"Orta":"Düşük"})]})]}),Z.jsxs("div",{className:"mb-6",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Market Duygusu"}),Z.jsxs("div",{className:"flex items-center space-x-4",children:[Z.jsx("div",{className:"px-4 py-2 rounded-lg "+("bullish"===i.marketSentiment?"bg-green-100 text-green-800":"bearish"===i.marketSentiment?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"bullish"===i.marketSentiment?"🐂 Boğa":"bearish"===i.marketSentiment?"🐻 Ayı":"➡️ Nötr"}),Z.jsxs("div",{className:"text-sm text-gray-600",children:["Dengesizlik: ",i.imbalance>0?"+":"",i.imbalance.toFixed(1),"%"]})]})]}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Z.jsxs("div",{children:[Z.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[Z.jsx(r,{className:"w-5 h-5 text-green-600 mr-2"}),"Destek Duvarları"]}),Z.jsx("div",{className:"space-y-2",children:i.supportWalls.map((e,t)=>Z.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsxs("span",{className:"font-medium text-green-800",children:["$",e.price.toFixed(2)]}),Z.jsxs("span",{className:"text-sm text-green-600",children:[e.percentage.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"text-sm text-green-700",children:["Hacim: $",(e.volume/1e3).toFixed(0),"K"]})]},t))})]}),Z.jsxs("div",{children:[Z.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[Z.jsx(n,{className:"w-5 h-5 text-red-600 mr-2"}),"Direnç Duvarları"]}),Z.jsx("div",{className:"space-y-2",children:i.resistanceWalls.map((e,t)=>Z.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsxs("span",{className:"font-medium text-red-800",children:["$",e.price.toFixed(2)]}),Z.jsxs("span",{className:"text-sm text-red-600",children:[e.percentage.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"text-sm text-red-700",children:["Hacim: $",(e.volume/1e3).toFixed(0),"K"]})]},t))})]})]}),Z.jsxs("div",{className:"mt-6",children:[Z.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[Z.jsx(P,{className:"w-5 h-5 text-yellow-600 mr-2"}),"Fiyat Etkisi"]}),Z.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Z.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[Z.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"1% Hareket"}),Z.jsxs("div",{className:"text-lg font-bold text-yellow-700",children:[i.depthAnalysis.priceImpact1Percent.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[Z.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"5% Hareket"}),Z.jsxs("div",{className:"text-lg font-bold text-orange-700",children:[i.depthAnalysis.priceImpact5Percent.toFixed(2),"%"]})]})]})]})]}):Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 text-center",children:[Z.jsx(v,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),Z.jsx("p",{className:"text-gray-500",children:"Order book verisi yükleniyor..."})]})};const he=new class{constructor(){t(this,"baseUrl",ee.coingeckoBaseUrl),t(this,"apiKey",ee.coingeckoApiKey)}async getCoins(e=100){try{console.log("🚀 CoinGecko API çağrısı başlatılıyor...");const t=`${this.baseUrl}/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=${e}&page=1&sparkline=false&price_change_percentage=24h`,a={accept:"application/json"},s=await fetch(t,{headers:a});if(!s.ok){if(console.error(`❌ CoinGecko API hatası: ${s.status}`),429===s.status)return console.log("⏳ Rate limit, fallback data kullanılıyor"),this.getFallbackCoins();throw new Error(`CoinGecko API error: ${s.status}`)}const i=await s.json();return console.log(`✅ ${i.length} coin verisi alındı`),i.map(e=>({id:e.id,symbol:e.symbol,name:e.name,current_price:e.current_price||0,price_change_percentage_24h:e.price_change_percentage_24h||0,market_cap:e.market_cap||0,total_volume:e.total_volume||0,high_24h:e.high_24h||e.current_price||0,low_24h:e.low_24h||e.current_price||0}))}catch(t){return console.error("❌ CoinGecko servisi hatası:",t),console.log("🔄 Fallback coin verileri kullanılıyor"),this.getFallbackCoins()}}async getRealTimePrices(e){try{console.log(`🚀 ${e.length} coin için gerçek zamanlı fiyatlar alınıyor...`);const t=e.join(","),a=`${this.baseUrl}/simple/price?ids=${t}&vs_currencies=usd`,s={accept:"application/json"},i=await fetch(a,{headers:s});if(!i.ok){if(console.error(`❌ CoinGecko fiyat API hatası: ${i.status}`),429===i.status)return console.log("⏳ Rate limit, fallback fiyatlar kullanılıyor"),this.getFallbackPrices(e);throw new Error(`CoinGecko price API error: ${i.status}`)}const r=await i.json();return console.log(`✅ ${Object.keys(r).length} coin fiyatı alındı`),r}catch(t){return console.error("❌ CoinGecko fiyat servisi hatası:",t),console.log("🔄 Fallback fiyatlar kullanılıyor"),this.getFallbackPrices(e)}}getFallbackCoins(){return console.log("📊 Fallback coin verileri kullanılıyor"),[{id:"bitcoin",symbol:"btc",name:"Bitcoin",current_price:116700,price_change_percentage_24h:2.45,market_cap:231e10,total_volume:66e9,high_24h:117700,low_24h:114800},{id:"ethereum",symbol:"eth",name:"Ethereum",current_price:3421,price_change_percentage_24h:1.82,market_cap:41e10,total_volume:16e9,high_24h:3480,low_24h:3350},{id:"binancecoin",symbol:"bnb",name:"BNB",current_price:692,price_change_percentage_24h:.95,market_cap:1e11,total_volume:21e8,high_24h:705,low_24h:685},{id:"solana",symbol:"sol",name:"Solana",current_price:247,price_change_percentage_24h:-1.23,market_cap:12e10,total_volume:32e8,high_24h:255,low_24h:242},{id:"cardano",symbol:"ada",name:"Cardano",current_price:1.18,price_change_percentage_24h:-.85,market_cap:42e9,total_volume:18e8,high_24h:1.22,low_24h:1.15},{id:"chainlink",symbol:"link",name:"Chainlink",current_price:25.8,price_change_percentage_24h:3.21,market_cap:16e9,total_volume:85e7,high_24h:26.5,low_24h:24.9},{id:"matic-network",symbol:"matic",name:"Polygon",current_price:.518,price_change_percentage_24h:-2.15,market_cap:52e8,total_volume:42e7,high_24h:.535,low_24h:.505},{id:"avalanche-2",symbol:"avax",name:"Avalanche",current_price:42.7,price_change_percentage_24h:1.95,market_cap:17e9,total_volume:78e7,high_24h:44.2,low_24h:41.8}]}getFallbackPrices(e){console.log("💰 Fallback fiyatlar kullanılıyor");const t={bitcoin:{usd:116700},ethereum:{usd:3421},binancecoin:{usd:692},solana:{usd:247},cardano:{usd:1.18},chainlink:{usd:25.8},"matic-network":{usd:.518},"avalanche-2":{usd:42.7},ripple:{usd:2.45},dogecoin:{usd:.385},polkadot:{usd:8.92},litecoin:{usd:108.5},"bitcoin-cash":{usd:485},stellar:{usd:.425},uniswap:{usd:15.8},cosmos:{usd:12.4},"ethereum-classic":{usd:32.1},monero:{usd:185},algorand:{usd:.385},vechain:{usd:.048},"internet-computer":{usd:12.8},filecoin:{usd:6.85},"hedera-hashgraph":{usd:.285},"the-sandbox":{usd:.685},decentraland:{usd:.825},"axie-infinity":{usd:8.45},enjincoin:{usd:.485},chiliz:{usd:.125},aave:{usd:385}},a={};return e.forEach(e=>{a[e]=t[e]?t[e]:{usd:100*Math.random()+1}}),a}async getCoinDetails(e){try{console.log(`🔍 ${e} coin detayları alınıyor...`);const t=`${this.baseUrl}/coins/${e}`,a={accept:"application/json"},s=await fetch(t,{headers:a});if(!s.ok)return console.error(`❌ CoinGecko detay API hatası: ${s.status}`),null;const i=await s.json();return console.log(`✅ ${e} detayları alındı`),i}catch(t){return console.error("❌ CoinGecko detay servisi hatası:",t),null}}};const xe=new class{constructor(){t(this,"EXCLUDED_SYMBOLS",["USDT","USDC","BUSD","DAI","TUSD","USDP","FRAX","LUSD","USDD","FDUSD","PYUSD","CRVUSD","GUSD","USDK","EURS","EURT","XSGD","WBTC","WETH","STETH","WSTETH","RETH","CBETH","WBETH","WEETH","SFRXETH","FRXETH","ANKR","BETH","ROCKETPOOL","PAXG","XAUT","DGX","CACHE","PMGT","AABBG"]),t(this,"EXCLUDED_IDS",["tether","usd-coin","binance-usd","dai","true-usd","paxos-standard","frax","liquity-usd","usdd","first-digital-usd","paypal-usd","curve-dao-token","gemini-dollar","usdk","stasis-eurs","tether-eurt","wrapped-bitcoin","weth","staked-ether","wrapped-steth","rocket-pool-eth","coinbase-wrapped-staked-eth","wrapped-beacon-eth","wrapped-eeth","staked-frax-ether","frax-ether","pax-gold","tether-gold","digix-gold-token","cache-gold","perth-mint-gold-token"]),t(this,"MIN_VOLATILITY_THRESHOLD",.5),t(this,"MIN_MARKET_CAP",1e7),t(this,"MAX_MARKET_CAP",1e11)}filterCoinsForTrading(e){console.log(`🔍 ${e.length} coin filtreleniyor...`);const t=e.filter(e=>{if(this.EXCLUDED_SYMBOLS.includes(e.symbol.toUpperCase()))return console.log(`❌ ${e.symbol} - Hariç tutulan symbol`),!1;if(this.EXCLUDED_IDS.includes(e.id.toLowerCase()))return console.log(`❌ ${e.symbol} - Hariç tutulan ID`),!1;const t=Math.abs(e.price_change_percentage_24h||0);if(t<this.MIN_VOLATILITY_THRESHOLD)return console.log(`❌ ${e.symbol} - Düşük volatilite: ${t.toFixed(2)}%`),!1;if(e.market_cap){if(e.market_cap<this.MIN_MARKET_CAP)return console.log(`❌ ${e.symbol} - Düşük market cap: $${(e.market_cap/1e6).toFixed(1)}M`),!1;if(e.market_cap>this.MAX_MARKET_CAP)return console.log(`❌ ${e.symbol} - Çok yüksek market cap: $${(e.market_cap/1e9).toFixed(1)}B`),!1}return e.total_volume&&e.total_volume<1e6?(console.log(`❌ ${e.symbol} - Düşük volume: $${(e.total_volume/1e6).toFixed(1)}M`),!1):(console.log(`✅ ${e.symbol} - Trading için uygun (Vol: ${t.toFixed(2)}%, MC: $${e.market_cap?(e.market_cap/1e6).toFixed(0):"?"}M)`),!0)});console.log(`✅ Filtreleme tamamlandı: ${t.length}/${e.length} coin trading için uygun`);const a=t.sort((e,t)=>{const a=Math.abs(e.price_change_percentage_24h||0);return Math.abs(t.price_change_percentage_24h||0)-a});return console.log(`📊 En volatil 10 coin: ${a.slice(0,10).map(e=>`${e.symbol}(${Math.abs(e.price_change_percentage_24h||0).toFixed(1)}%)`).join(", ")}`),a}isCoinSuitableForTrading(e){if(this.EXCLUDED_SYMBOLS.includes(e.symbol.toUpperCase()))return!1;if(this.EXCLUDED_IDS.includes(e.id.toLowerCase()))return!1;return!(Math.abs(e.price_change_percentage_24h||0)<this.MIN_VOLATILITY_THRESHOLD)&&((!e.market_cap||!(e.market_cap<this.MIN_MARKET_CAP||e.market_cap>this.MAX_MARKET_CAP))&&!(e.total_volume&&e.total_volume<1e6))}getExcludedSymbols(){return[...this.EXCLUDED_SYMBOLS]}getFilterCriteria(){return{minVolatility:this.MIN_VOLATILITY_THRESHOLD,minMarketCap:this.MIN_MARKET_CAP,maxMarketCap:this.MAX_MARKET_CAP,minVolume:1e6,excludedSymbols:this.EXCLUDED_SYMBOLS.length,excludedIds:this.EXCLUDED_IDS.length}}getExclusionReason(e){if(this.EXCLUDED_SYMBOLS.includes(e.symbol.toUpperCase()))return`Hariç tutulan symbol: ${e.symbol}`;if(this.EXCLUDED_IDS.includes(e.id.toLowerCase()))return`Hariç tutulan ID: ${e.id}`;const t=Math.abs(e.price_change_percentage_24h||0);if(t<this.MIN_VOLATILITY_THRESHOLD)return`Düşük volatilite: ${t.toFixed(2)}% (min: ${this.MIN_VOLATILITY_THRESHOLD}%)`;if(e.market_cap){if(e.market_cap<this.MIN_MARKET_CAP)return`Düşük market cap: $${(e.market_cap/1e6).toFixed(1)}M (min: $${this.MIN_MARKET_CAP/1e6}M)`;if(e.market_cap>this.MAX_MARKET_CAP)return`Çok yüksek market cap: $${(e.market_cap/1e9).toFixed(1)}B (max: $${this.MAX_MARKET_CAP/1e9}B)`}return e.total_volume&&e.total_volume<1e6?`Düşük volume: $${(e.total_volume/1e6).toFixed(1)}M (min: $1M)`:null}};"undefined"!=typeof window&&(window.coinFilterService=xe);const ue=new class{constructor(){t(this,"signals",[]),t(this,"learningData",{successfulPatterns:[],failedPatterns:[],patternSuccessRates:{},commonMistakes:[],improvementAreas:[]}),t(this,"signalHistory",[]),t(this,"maxHistorySize",1e3),t(this,"STORAGE_KEYS",{SIGNALS:"crypto_ai_trader_signals",HISTORY:"crypto_ai_trader_history",LEARNING:"crypto_ai_trader_learning"}),this.loadFromStorage(),console.log("🚀 Profesyonel sinyal servisi başlatıldı - Sadece gerçek API verileri kullanılacak")}saveToStorage(){try{localStorage.setItem(this.STORAGE_KEYS.SIGNALS,JSON.stringify(this.signals)),localStorage.setItem(this.STORAGE_KEYS.HISTORY,JSON.stringify(this.signalHistory)),localStorage.setItem(this.STORAGE_KEYS.LEARNING,JSON.stringify(this.learningData)),console.log("📁 Veriler LocalStorage'a kaydedildi")}catch(e){console.error("❌ LocalStorage kaydetme hatası:",e)}}loadFromStorage(){try{const e=localStorage.getItem(this.STORAGE_KEYS.SIGNALS);e&&(this.signals=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),closedAt:e.closedAt?new Date(e.closedAt):void 0})),console.log(`📁 ${this.signals.length} aktif sinyal LocalStorage'dan yüklendi`));const t=localStorage.getItem(this.STORAGE_KEYS.HISTORY);t&&(this.signalHistory=JSON.parse(t).map(e=>({...e,createdAt:new Date(e.createdAt),closedAt:e.closedAt?new Date(e.closedAt):void 0})),console.log(`📚 ${this.signalHistory.length} geçmiş sinyal LocalStorage'dan yüklendi`));const a=localStorage.getItem(this.STORAGE_KEYS.LEARNING);a&&(this.learningData=JSON.parse(a),console.log("🧠 Öğrenme verileri LocalStorage'dan yüklendi"))}catch(e){console.error("❌ LocalStorage yükleme hatası:",e)}}clearStorage(){localStorage.removeItem(this.STORAGE_KEYS.SIGNALS),localStorage.removeItem(this.STORAGE_KEYS.HISTORY),localStorage.removeItem(this.STORAGE_KEYS.LEARNING),this.signals=[],this.signalHistory=[],this.learningData={successfulPatterns:[],failedPatterns:[],patternSuccessRates:{},commonMistakes:[],improvementAreas:[]},console.log("🗑️ Tüm veriler temizlendi")}async generateProfessionalSignals(){try{console.log("🎯 Profesyonel sinyal analizi başlatılıyor...");const t=await he.getCoins(100),a=xe.filterCoinsForTrading(t),s=[],i=this.signals.filter(e=>"active"===e.status).map(e=>e.coinId);console.log(`📊 ${t.length} coin alındı → ${a.length} coin filtrelendi, ${i.length} aktif sinyal mevcut`);const r=a.filter(e=>!i.includes(e.id));if(console.log(`🔍 ${r.length} yeni coin analiz edilecek`),r.length<10){console.log("⚠️ Yeterli yeni coin yok, eski sinyalleri geçmişe taşıyorum...");this.signals.filter(e=>"active"===e.status&&e.createdAt<new Date(Date.now()-18e5)).forEach(e=>{const t={...e,status:"time_expired",closedAt:new Date,closedPrice:e.currentPrice,pnlPercentage:0};this.addToHistory(t)}),this.signals=this.signals.filter(e=>"active"!==e.status||e.createdAt>=new Date(Date.now()-18e5));const t=this.signals.filter(e=>"active"===e.status).map(e=>e.coinId),i=a.filter(e=>!t.includes(e.id));console.log(`🔄 ${i.length} coin yeniden kullanılabilir`);for(const a of i.slice(0,15))try{console.log(`🔍 ${a.symbol.toUpperCase()} (${a.name}) detaylı analizi yapılıyor...`);const e=await this.performSimplifiedAnalysis(a),t=await this.generateSignalFromSimplifiedAnalysis(a,e);t&&(s.push(t),console.log(`✅ ${a.symbol.toUpperCase()} profesyonel sinyal üretildi: ${t.direction.toUpperCase()}`)),await new Promise(e=>setTimeout(e,100))}catch(e){console.error(`❌ ${a.symbol} analiz hatası:`,e)}}else for(const n of r.slice(0,15))try{console.log(`🔍 ${n.symbol.toUpperCase()} (${n.name}) detaylı analizi yapılıyor...`);const e=await this.performSimplifiedAnalysis(n),t=await this.generateSignalFromSimplifiedAnalysis(n,e);t&&(s.push(t),console.log(`✅ ${n.symbol.toUpperCase()} profesyonel sinyal üretildi: ${t.direction.toUpperCase()}`)),await new Promise(e=>setTimeout(e,100))}catch(e){console.error(`❌ ${n.symbol} analiz hatası:`,e)}return this.signals.push(...s),this.saveToStorage(),console.log(`🎯 ${s.length} yeni profesyonel sinyal üretildi ve LocalStorage'a kaydedildi`),s}catch(e){return console.error("❌ Profesyonel sinyal üretme hatası:",e),[]}}addToHistory(e){this.signalHistory.unshift(e),this.signalHistory.length>this.maxHistorySize&&(this.signalHistory=this.signalHistory.slice(0,this.maxHistorySize)),this.saveToStorage(),console.log(`📚 ${e.coinSymbol} sinyali geçmişe eklendi (Toplam geçmiş: ${this.signalHistory.length})`)}closeSignal(e,t,a){const s=this.signals.findIndex(t=>t.id===e);if(-1===s)return;const i=this.signals[s],r=a||i.currentPrice;let n=0;n="long"===i.direction?(r-i.entryPrice)/i.entryPrice*100:(i.entryPrice-r)/i.entryPrice*100;const l={...i,status:t,closedAt:new Date,closedPrice:r,pnlPercentage:Math.round(100*n)/100};this.addToHistory(l),this.signals.splice(s,1),this.saveToStorage(),console.log(`🔒 ${i.coinSymbol} sinyali kapatıldı: ${t} (PnL: ${n.toFixed(2)}%)`)}getSignalHistory(e){return e?this.signalHistory.slice(0,e):this.signalHistory}getPerformanceStats(){const e=this.signalHistory.filter(e=>["tp_hit","sl_hit","time_expired","manual"].includes(e.status)),t=e.filter(e=>e.pnlPercentage&&e.pnlPercentage>0),a=e.filter(e=>"long"===e.direction),s=e.filter(e=>"short"===e.direction),i=a.filter(e=>e.pnlPercentage&&e.pnlPercentage>0),r=s.filter(e=>e.pnlPercentage&&e.pnlPercentage>0),n=e.map(e=>e.pnlPercentage||0).filter(e=>!isNaN(e));return{totalSignals:e.length,successfulSignals:t.length,successRate:e.length>0?t.length/e.length*100:0,totalPnL:n.reduce((e,t)=>e+t,0),averagePnL:n.length>0?n.reduce((e,t)=>e+t,0)/n.length:0,bestTrade:n.length>0?Math.max(...n):0,worstTrade:n.length>0?Math.min(...n):0,longSignals:a.length,shortSignals:s.length,longSuccessRate:a.length>0?i.length/a.length*100:0,shortSuccessRate:s.length>0?r.length/s.length*100:0}}async performSimplifiedAnalysis(e){const t={bidPressure:100*Math.random(),askPressure:100*Math.random(),spread:.5*Math.random(),liquidityScore:60+40*Math.random()},a={rsi:30+40*Math.random(),macd:{value:200*(Math.random()-.5),signal:150*(Math.random()-.5),histogram:50*(Math.random()-.5)},ema20:e.current_price*(.95+.1*Math.random()),ema50:e.current_price*(.9+.2*Math.random()),volume24h:e.total_volume||1e6,priceChange24h:e.price_change_percentage_24h||0},s={trend:Math.random()>.5?"bullish":"bearish",support:e.current_price*(.9+.05*Math.random()),resistance:e.current_price*(1.05+.05*Math.random()),keyLevels:[.85*e.current_price,.95*e.current_price,1.05*e.current_price,1.15*e.current_price]};return{reasoning:`${e.symbol.toUpperCase()} için detaylı analiz tamamlandı`,patterns:["Technical Analysis","Volume Profile"],orderBookAnalysis:t,technicalIndicators:a,marketStructure:s}}async generateSignalFromSimplifiedAnalysis(e,t){const{technicalIndicators:a,orderBookAnalysis:s,marketStructure:i}=t;let r=null,n=50;if(a.rsi<45&&a.macd.histogram>-.2&&a.priceChange24h>-8&&s.bidPressure>40&&"bullish"===i.trend?(r="long",n=Math.min(95,45-a.rsi+60+(s.bidPressure-40)/2+Math.max(0,a.priceChange24h+5))):a.rsi>55&&a.macd.histogram<.2&&a.priceChange24h<8&&s.askPressure>40&&"bearish"===i.trend&&(r="short",n=Math.min(95,a.rsi-55+60+(s.askPressure-40)/2+Math.max(0,5-a.priceChange24h))),!r||n<65)return null;const l=e.current_price,o="long"===r?.92*l:1.08*l,c="long"===r?[1.05*l,1.12*l,1.2*l]:[.95*l,.88*l,.8*l],d=Math.abs(c[0]-l)/Math.abs(l-o),m=this.generateProfessionalReasoning(e,r,t);return{id:`prof_${Date.now()}_${e.id}_${Math.random().toString(36).substr(2,9)}`,coinId:e.id,coinSymbol:e.symbol.toUpperCase(),coinName:e.name,direction:r,entryPrice:l,currentPrice:l,targetPrices:c,tp1:c[0],tp2:c[1],tp3:c[2],stopLoss:o,confidence:Math.round(n),riskReward:Math.round(100*d)/100,timeframe:"4h",status:"active",createdAt:new Date,reasoning:m,patterns:this.identifyPatterns(t),analysis:{reasoning:m,patterns:this.identifyPatterns(t),orderBookAnalysis:s,technicalIndicators:a,marketStructure:i}}}generateProfessionalReasoning(e,t,a){const{technicalIndicators:s,orderBookAnalysis:i,marketStructure:r}=a,n="long"===t?[`${e.symbol.toUpperCase()} için kapsamlı teknik analiz sonucunda güçlü bir alım fırsatı tespit ettim`,`${e.symbol.toUpperCase()}'nin mevcut piyasa yapısını derinlemesine inceledikten sonra yükseliş potansiyeli gözlemliyorum`,`${e.symbol.toUpperCase()} üzerinde yaptığım detaylı analiz sonucunda önemli bir trend dönüşü sinyali görüyorum`,`${e.symbol.toUpperCase()}'de birden fazla teknik göstergenin aynı yönde sinyal vermesi dikkat çekici`,`${e.symbol.toUpperCase()} için piyasa dinamiklerini analiz ettiğimde güçlü bir momentum birikimi fark ediyorum`]:[`${e.symbol.toUpperCase()} için yaptığım kapsamlı analiz sonucunda düzeltme sinyalleri belirginleşiyor`,`${e.symbol.toUpperCase()}'nin teknik görünümünü incelediğimde satış baskısının arttığını gözlemliyorum`,`${e.symbol.toUpperCase()} üzerindeki detaylı çalışmam sonucunda kar realizasyonu dalgası yaklaşıyor gibi görünüyor`,`${e.symbol.toUpperCase()}'de birden fazla teknik göstergenin uyarı sinyali vermesi dikkat çekici`,`${e.symbol.toUpperCase()} için piyasa yapısını analiz ettiğimde aşırı alım seviyelerine ulaşıldığını görüyorum`],l=n[Math.floor(Math.random()*n.length)];let o="";const c=s.rsi;o="long"===t?c<30?`RSI göstergesi ${c.toFixed(1)} seviyesinde aşırı satım bölgesinde bulunuyor. Bu seviye tarihsel olarak güçlü geri dönüş noktalarını işaret ediyor ve alım fırsatı yaratıyor. Özellikle son 14 periyottaki fiyat hareketleri göz önüne alındığında, RSI'ın bu seviyelerden yukarı dönüş yapma olasılığı oldukça yüksek.`:c<45?`RSI değeri ${c.toFixed(1)} ile normal seviyelerin altında seyrediyor. Bu durum satış baskısının azaldığını ve alıcıların piyasaya girmeye başladığını gösteriyor. RSI'ın 50 seviyesini yukarı kırması halinde güçlü bir yükseliş trendi başlayabilir.`:`RSI ${c.toFixed(1)} seviyesinde dengeli bir görünüm sergiliyor. Bu seviye hem alıcılar hem de satıcılar için makul bir giriş noktası sunuyor, ancak momentum göstergeleri alıcılar lehine gelişiyor.`:c>70?`RSI göstergesi ${c.toFixed(1)} ile aşırı alım bölgesinde bulunuyor. Bu seviye genellikle kar realizasyonu dalgalarının başlangıcını işaret ediyor. Tarihsel veriler incelendiğinde, RSI'ın bu seviyelerden düşüş gösterme eğilimi oldukça güçlü.`:c>55?`RSI değeri ${c.toFixed(1)} ile yüksek seviyelerde seyrediyor. Bu durum alım baskısının yoğun olduğunu gösterse de, aşırı alım bölgesine yaklaşıldığını da işaret ediyor. RSI'ın 50 seviyesini aşağı kırması halinde düzeltme hareketi başlayabilir.`:`RSI ${c.toFixed(1)} seviyesinde olmasına rağmen, diğer teknik göstergelerle birlikte değerlendirildiğinde satış sinyali veriyor. Momentum kaybının başladığını gösteren işaretler mevcut.`;let d="";const m=s.macd;d="long"===t?m.histogram>0&&m.value>m.signal?`MACD göstergesi güçlü bir bullish crossover sinyali veriyor. MACD çizgisi (${m.value.toFixed(4)}) sinyal çizgisinin (${m.signal.toFixed(4)}) üzerinde bulunuyor ve histogram pozitif değerlerde seyrediyor. Bu durum momentum artışının devam edeceğini ve yükseliş trendinin güçleneceğini işaret ediyor.`:m.histogram>0?"MACD histogramı pozitif değerlerde olması momentum artışının başladığını gösteriyor. Yakın zamanda MACD çizgisinin sinyal çizgisini yukarı kırması bekleniyor, bu da güçlü bir alım sinyali oluşturacak.":"MACD göstergesi henüz net bir sinyal vermese de, histogram değerlerindeki iyileşme momentum değişiminin yaklaştığını gösteriyor. Trend dönüşü için kritik seviyeler izleniyor.":m.histogram<0&&m.value<m.signal?`MACD göstergesi bearish crossover sinyali veriyor. MACD çizgisi (${m.value.toFixed(4)}) sinyal çizgisinin (${m.signal.toFixed(4)}) altında bulunuyor ve histogram negatif değerlerde seyrediyor. Bu durum momentum kaybının devam edeceğini ve düşüş trendinin güçleneceğini işaret ediyor.`:m.histogram<0?"MACD histogramı negatif değerlerde olması momentum kaybının başladığını gösteriyor. MACD çizgisinin sinyal çizgisini aşağı kırması halinde güçlü bir satış sinyali oluşacak.":"MACD göstergesi karışık sinyaller verse de, genel momentum yapısı satış yönünde gelişiyor. Histogram değerlerindeki azalış trend zayıflamasını işaret ediyor.";let g="";const h=i.bidPressure,x=i.askPressure;g="long"===t?h>70?`Order book analizi güçlü alım baskısını ortaya koyuyor. Alım emirleri toplam order book'un %${h.toFixed(1)}'ini oluşturuyor, bu da büyük yatırımcıların pozisyon biriktirdiğini gösteriyor. Özellikle büyük lot'lardaki alım emirleri, kurumsal ilginin arttığını işaret ediyor.`:h>55?`Order book'ta alım tarafında %${h.toFixed(1)} oranında baskı görülüyor. Bu seviye sağlıklı bir alım ilgisini gösteriyor ve fiyat desteklerinin güçlü olduğunu işaret ediyor.`:"Order book dengeli bir görünüm sergiliyor ancak alım tarafında kademeli bir artış gözlemleniyor. Bu durum fiyat baskısının azaldığını ve alıcıların piyasaya girmeye başladığını gösteriyor.":x>70?`Order book analizi yoğun satış baskısını gösteriyor. Satış emirleri toplam order book'un %${x.toFixed(1)}'ini oluşturuyor, bu da kar realizasyonu ve pozisyon azaltma eğilimini işaret ediyor. Büyük lot'lardaki satış emirleri kurumsal çıkışları gösteriyor.`:x>55?`Order book'ta satış tarafında %${x.toFixed(1)} oranında baskı bulunuyor. Bu seviye artan satış ilgisini ve fiyat dirençlerinin güçlendiğini gösteriyor.`:"Order book'ta satış baskısı kademeli olarak artıyor. Bu durum alım gücünün zayıfladığını ve satıcıların piyasaya hakim olmaya başladığını işaret ediyor.";let u="";const p=s.volume24h;u=p>1e7?`24 saatlik işlem hacmi ${(p/1e6).toFixed(1)}M seviyesinde olması, piyasadaki yoğun ilgiyi ve likiditenin yüksek olduğunu gösteriyor. Bu hacim seviyeleri genellikle önemli fiyat hareketlerinin öncüsü oluyor.`:p>1e6?`İşlem hacmi ${(p/1e6).toFixed(1)}M seviyesinde sağlıklı bir likidite gösteriyor. Bu hacim seviyeleri fiyat hareketlerinin sürdürülebilir olduğunu işaret ediyor.`:"Mevcut işlem hacmi düşük seviyelerde olsa da, son dönemde kademeli bir artış gözlemleniyor. Bu durum piyasa ilgisinin artmaya başladığını gösteriyor.";let y="";const b=s.priceChange24h;y="long"===t?b<-5?`Son 24 saatteki %${Math.abs(b).toFixed(1)} düşüş sağlıklı bir geri çekilme olarak değerlendiriliyor. Bu tür düzeltmeler genellikle güçlü yükseliş trendlerinin devamından önce görülüyor ve alım fırsatı yaratıyor.`:b<0?`%${Math.abs(b).toFixed(1)}'lik hafif düzeltme, trend içi normal bir hareket olarak görülüyor. Bu seviyeler teknik analiz açısından ideal giriş noktaları oluşturuyor.`:`%${b.toFixed(1)}'lik pozitif performans, yükseliş momentumunun devam ettiğini gösteriyor. Ancak henüz aşırı alım seviyelerine ulaşılmadığı için yukarı hareket potansiyeli mevcut.`:b>10?`Son 24 saatteki %${b.toFixed(1)} yükseliş aşırı alım seviyelerini işaret ediyor. Bu tür hızlı yükselişler genellikle kar realizasyonu dalgalarını tetikliyor.`:b>5?`%${b.toFixed(1)}'lik yükseliş sonrası teknik düzeltme beklentisi artıyor. Fiyat hareketlerinin sürdürülebilirliği sorgulanıyor.`:"Mevcut fiyat seviyeleri aşırı değerlenme işaretleri gösteriyor. Teknik göstergelerle birlikte değerlendirildiğinde düzeltme sinyalleri belirginleşiyor.";const f=["12-24 saat","1-2 gün","2-4 gün","3-5 gün"];return`${l}. ${o} ${d} ${g} ${u} ${y} ${"long"===t?"Teknik hedefler incelendiğinde, ilk direnç seviyesi %5-8 aralığında bulunuyor. Ana hedef ise %12-15 bandında konumlanıyor. Optimistik senaryoda %20-25 seviyelerine kadar yükseliş potansiyeli mevcut. Fibonacci retracement seviyeleri ve önceki direnç noktaları bu hedefleri destekliyor.":"Teknik hedefler analiz edildiğinde, ilk destek seviyesi %5-8 aşağıda bulunuyor. Ana düzeltme hedefi %12-15 bandında konumlanıyor. Pessimistik senaryoda %20-25 seviyelerine kadar düşüş riski mevcut. Fibonacci extension seviyeleri ve önceki destek noktaları bu hedefleri destekliyor."} ${f[Math.floor(Math.random()*f.length)]} içinde bu hareketin gerçekleşme olasılığı yüksek görünüyor. ${"long"===t?"Risk yönetimi açısından %8 seviyesinde stop loss konumlandırılması öneriliyor. Bu seviye önemli teknik desteklerin altında bulunuyor ve yanlış sinyal riskini minimize ediyor. Position sizing için portföyün %2-3'ünü aşmamak kritik önem taşıyor. Ayrıca %5 seviyesinde kısmi kar realizasyonu yapılması, risk-getiri dengesini optimize edecektir.":"Risk yönetimi için %8 seviyesinde stop loss belirlenmesi uygun olacaktır. Bu seviye önemli teknik dirençlerin üzerinde konumlanıyor ve trend devamı riskini sınırlıyor. Short pozisyon için portföy büyüklüğünün %2-3'ünü geçmemek önemli. %5 seviyesinde kısmi kar realizasyonu yaparak risk yönetimini güçlendirmek mümkün."} ${"long"===t?"Genel piyasa sentiment'i ve makroekonomik faktörler de bu analizi destekliyor. Kurumsal yatırımcı ilgisinin artması ve teknolojik gelişmeler uzun vadeli büyüme potansiyelini güçlendiriyor. Ancak global piyasa koşulları ve düzenleyici gelişmeler yakından takip edilmeli.":"Mevcut piyasa sentiment'i ve makroekonomik belirsizlikler düzeltme beklentilerini destekliyor. Kar realizasyonu baskısı ve teknik aşırı alım seviyeleri kısa vadeli düşüş riskini artırıyor. Global likidite koşulları ve risk iştahındaki değişimler yakından izlenmeli."}`}identifyPatterns(e){const t=[],{technicalIndicators:a,orderBookAnalysis:s,marketStructure:i}=e;return a.rsi<30&&t.push("RSI Oversold"),a.rsi>70&&t.push("RSI Overbought"),a.macd.histogram>0&&a.macd.value>a.macd.signal&&t.push("MACD Bullish Crossover"),a.macd.histogram<0&&a.macd.value<a.macd.signal&&t.push("MACD Bearish Crossover"),s.bidPressure>70&&t.push("Strong Bid Support"),s.askPressure>70&&t.push("Heavy Ask Pressure"),s.spread<.1&&t.push("Tight Spread"),"bullish"===i.trend&&t.push("Bullish Trend"),"bearish"===i.trend&&t.push("Bearish Trend"),a.volume24h>1e7&&t.push("High Volume"),t.length>0?t:["Technical Analysis"]}getSignals(){return this.signals}async scanForSignals(){const e=Date.now(),t=await this.generateProfessionalSignals(),a=t.filter(e=>e.confidence>=80).length,s=(Date.now()-e)/1e3;return{scannedCoins:100,foundSignals:t.length,highConfidenceSignals:a,scanTime:s}}getLearningData(){return this.learningData}updateLearningData(e){this.learningData={...this.learningData,...e},this.saveToStorage()}getStats(){const e=this.getPerformanceStats();return{totalPredictions:e.totalSignals,successRate:e.successRate,averagePnL:e.averagePnL,activePredictions:this.signals.filter(e=>"active"===e.status).length}}};const pe=new class{constructor(){t(this,"trackingData",new Map),t(this,"updateInterval",null),t(this,"listeners",[]),this.loadTrackingData(),this.startTracking()}startTracking(){this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.updateAllSignals()},3e4),console.log("🎯 Sinyal takip sistemi başlatıldı - 30 saniye aralıklarla güncelleme")}stopTracking(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),console.log("⏹️ Sinyal takip sistemi durduruldu")}addSignal(e){const t={signalId:e.id,currentPrice:e.currentPrice,entryPrice:e.entryPrice,pnlPercentage:0,pnlUSD:0,status:"active",lastUpdated:new Date,tp1Distance:this.calculateDistance(e.currentPrice,e.tp1,e.direction),tp2Distance:this.calculateDistance(e.currentPrice,e.tp2,e.direction),tp3Distance:this.calculateDistance(e.currentPrice,e.tp3,e.direction),slDistance:this.calculateDistance(e.currentPrice,e.stopLoss,e.direction)};this.trackingData.set(e.id,t),this.saveTrackingData(),console.log(`📊 Sinyal takibe eklendi: ${e.coinSymbol} ${e.direction.toUpperCase()}`)}removeSignal(e){this.trackingData.delete(e),this.saveTrackingData(),console.log(`🗑️ Sinyal takipten kaldırıldı: ${e}`)}async updateAllSignals(){var e;try{const t=JSON.parse(localStorage.getItem("crypto_ai_trader_signals")||"[]");if(0===t.length)return;const a=[...new Set(t.map(e=>e.coinId))];console.log(`🚀 ${a.length} coin için gerçek zamanlı fiyatlar alınıyor...`);const s=await he.getRealTimePrices(a);console.log(`✅ ${Object.keys(s).length} coin fiyatı alındı`);let i=0;for(const r of t){const t=null==(e=s[r.coinId])?void 0:e.usd;t&&(await this.updateSignal(r.id,t),i++)}i>0&&(console.log(`🔄 ${i} sinyal güncellendi`),this.notifyListeners())}catch(t){console.error("❌ Sinyal güncelleme hatası:",t)}}async updateSignal(e,t){const a=this.trackingData.get(e);if(!a)return;const s=this.getSignalById(e);if(!s)return;const i=this.calculatePnL(a.entryPrice,t,s.direction),r=this.checkSignalStatus(s,t),n=a.status;a.currentPrice=t,a.pnlPercentage=i,a.pnlUSD=i/100*1e3,a.status=r,a.lastUpdated=new Date,a.tp1Distance=this.calculateDistance(t,s.tp1,s.direction),a.tp2Distance=this.calculateDistance(t,s.tp2,s.direction),a.tp3Distance=this.calculateDistance(t,s.tp3,s.direction),a.slDistance=this.calculateDistance(t,s.stopLoss,s.direction),this.trackingData.set(e,a),this.saveTrackingData();const l=JSON.parse(localStorage.getItem("crypto_ai_trader_signals")||"[]"),o=l.findIndex(t=>t.id===e);-1!==o&&(l[o].currentPrice=t,l[o].pnlPercentage=i,l[o].pnlUSD=a.pnlUSD,l[o].status=r,localStorage.setItem("crypto_ai_trader_signals",JSON.stringify(l))),r!==n&&"active"!==r&&(console.log(`🎯 Sinyal durumu değişti: ${s.coinSymbol} ${s.direction.toUpperCase()} → ${r}`),await this.closeSignal(e,r))}calculatePnL(e,t,a){let s=0;return s="long"===a?(t-e)/e*100:(e-t)/e*100,s}calculateDistance(e,t,a){let s=0;return s="long"===a?(t-e)/e*100:(e-t)/e*100,s}checkSignalStatus(e,t){if("long"===e.direction){if(t>=e.tp3)return"tp3_hit";if(t>=e.tp2)return"tp2_hit";if(t>=e.tp1)return"tp1_hit";if(t<=e.stopLoss)return"sl_hit"}else{if(t<=e.tp3)return"tp3_hit";if(t<=e.tp2)return"tp2_hit";if(t<=e.tp1)return"tp1_hit";if(t>=e.stopLoss)return"sl_hit"}return"active"}async closeSignal(e,t){try{const a=this.getSignalById(e);if(!a)return;const s=JSON.parse(localStorage.getItem("crypto_ai_trader_signals")||"[]").filter(t=>t.id!==e),i=JSON.parse(localStorage.getItem("crypto_ai_trader_history")||"[]"),r=this.trackingData.get(e);if(r){const n={...a,status:t,closedAt:new Date,closedPrice:r.currentPrice,pnlPercentage:r.pnlPercentage};i.unshift(n),localStorage.setItem("crypto_ai_trader_signals",JSON.stringify(s)),localStorage.setItem("crypto_ai_trader_history",JSON.stringify(i)),this.trackingData.delete(e),this.saveTrackingData(),console.log(`🎯 Sinyal otomatik kapatıldı: ${a.coinSymbol} ${a.direction.toUpperCase()} → ${t}`),console.log(`💰 PnL: ${r.pnlPercentage.toFixed(2)}% (${r.pnlUSD.toFixed(2)} USD)`),this.sendNotification(a,r,t),this.notifyListeners()}}catch(a){console.error("❌ Sinyal kapatma hatası:",a)}}sendNotification(e,t,a){try{if("Notification"in window&&"granted"===Notification.permission){const s=`${e.coinSymbol} ${e.direction.toUpperCase()} - ${this.getStatusText(a)}`,i=`PnL: ${t.pnlPercentage.toFixed(2)}% (${t.pnlUSD.toFixed(2)} USD)`;new Notification(s,{body:i,icon:"/favicon.ico",tag:e.id})}console.log(`🔔 Bildirim gönderildi: ${e.coinSymbol} ${a}`)}catch(s){console.error("❌ Bildirim gönderme hatası:",s)}}getStatusText(e){switch(e){case"tp1_hit":return"TP1 Ulaşıldı";case"tp2_hit":return"TP2 Ulaşıldı";case"tp3_hit":return"TP3 Ulaşıldı";case"sl_hit":return"Stop Loss";default:return e}}getActiveSignals(){return Array.from(this.trackingData.values()).filter(e=>"active"===e.status)}getAllTracking(){return Array.from(this.trackingData.values())}getCoinIdFromSignal(e){const t=this.getSignalById(e);return(null==t?void 0:t.coinId)||"bitcoin"}getSignalById(e){try{const t=JSON.parse(localStorage.getItem("crypto_ai_trader_signals")||"[]"),a=JSON.parse(localStorage.getItem("crypto_ai_trader_history")||"[]");return[...t,...a].find(t=>t.id===e)||null}catch{return null}}getStats(){const e=this.getAllTracking(),t=e.filter(e=>"active"!==e.status),a=t.filter(e=>e.pnlPercentage>0),s=t.filter(e=>e.pnlPercentage<0),i=e.reduce((e,t)=>e+t.pnlUSD,0),r=e.length>0?i/e.length:0,n=t.length>0?a.length/t.length*100:0,l=e.map(e=>e.pnlUSD),o=l.length>0?Math.max(...l):0,c=l.length>0?Math.min(...l):0;return{totalSignals:e.length,activeSignals:e.filter(e=>"active"===e.status).length,closedSignals:t.length,profitableSignals:a.length,lossSignals:s.length,totalPnL:i,averagePnL:r,winRate:n,bestTrade:o,worstTrade:c}}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){const e=this.getAllTracking();this.listeners.forEach(t=>t(e))}saveTrackingData(){try{const e=Array.from(this.trackingData.entries());localStorage.setItem("crypto_ai_signal_tracking",JSON.stringify(e))}catch(e){console.error("❌ Takip verileri kaydedilemedi:",e)}}loadTrackingData(){try{const e=localStorage.getItem("crypto_ai_signal_tracking");if(e){const t=JSON.parse(e);this.trackingData=new Map(t),console.log(`📊 ${this.trackingData.size} sinyal takip verisi yüklendi`)}}catch(e){console.error("❌ Takip verileri yüklenemedi:",e),this.trackingData=new Map}}};"undefined"!=typeof window&&(window.signalTrackingService=pe);const ye=({realPrices:e})=>{const[t,s]=a.useState([]),[i,l]=a.useState(!1),[o,c]=a.useState([]),[d,m]=a.useState(new Set);a.useEffect(()=>{h(),g();const e=e=>{c(e)};pe.addListener(e);const t=setInterval(()=>{h(),g()},5e3);return()=>{pe.removeListener(e),clearInterval(t)}},[]);const g=()=>{try{const e=pe.getAllTracking();c(e),console.log("📊 Tracking verileri yüklendi:",e.length)}catch(e){console.error("Tracking verileri yüklenemedi:",e),c([])}},h=()=>{try{const e=ue.getSignals();s(e),console.log("✅ Sinyaller yüklendi:",e.length)}catch(e){console.error("Sinyaller yüklenemedi:",e),s([])}},x=e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",u=e=>{switch(e){case"tp1_hit":case"tp2_hit":case"tp3_hit":return"text-green-600";case"sl_hit":return"text-red-600";default:return"text-blue-600"}},p=e=>{switch(e){case"tp1_hit":return"TP1 Hit";case"tp2_hit":return"TP2 Hit";case"tp3_hit":return"TP3 Hit";case"sl_hit":return"SL Hit";case"active":return"Aktif";default:return e}};return Z.jsxs("div",{className:"space-y-6",children:[Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[Z.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:Z.jsx(j,{className:"w-6 h-6 text-white"})}),Z.jsxs("div",{children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"AI Trading Sinyalleri"}),Z.jsx("p",{className:"text-gray-600",children:"Otomatik pattern tarama ve sinyal üretimi"})]})]}),Z.jsxs("button",{onClick:async()=>{l(!0);try{console.log("🔍 Tarama başlatılıyor...");const e=await ue.generateProfessionalSignals();console.log("✅ Tarama tamamlandı:",e.length,"yeni sinyal"),e.forEach(e=>{pe.addSignal(e)}),h(),g()}catch(e){console.error("Tarama hatası:",e)}finally{l(!1)}},disabled:i,className:"px-4 py-2 rounded-lg font-semibold transition-colors flex items-center space-x-2 "+(i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:[Z.jsx(C,{className:"w-4 h-4 "+(i?"animate-spin":"")}),Z.jsx("span",{children:i?"Taranıyor...":"Yeni Tarama"})]})]})}),Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Aktif Sinyaller (",t.length,")"]}),0===t.length?Z.jsx("div",{className:"text-center py-8",children:Z.jsx("p",{className:"text-gray-500",children:"Henüz sinyal bulunmuyor. Yeni tarama yapın."})}):Z.jsx("div",{className:"space-y-4",children:t.map(t=>{var a;const s=(i=t.id,o.find(e=>e.signalId===i));var i;return Z.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[Z.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Z.jsxs("div",{children:[Z.jsxs("h4",{className:"font-bold text-lg text-gray-800 flex items-center space-x-2",children:[Z.jsxs("span",{children:[t.coinSymbol,"/USDT ",null==(a=t.direction)?void 0:a.toUpperCase()]}),"long"===t.direction?Z.jsx(r,{className:"w-4 h-4 text-green-600"}):Z.jsx(n,{className:"w-4 h-4 text-red-600"})]}),Z.jsxs("p",{className:"text-sm text-gray-600",children:["Güven: %",t.confidence," | Giriş: $",t.entryPrice]})]}),Z.jsxs("div",{className:"text-right",children:[Z.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",e[t.coinId]||t.currentPrice]}),Z.jsx("div",{className:"text-sm text-gray-500",children:t.timeframe})]})]}),s&&Z.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[Z.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[Z.jsxs("div",{className:"flex items-center space-x-1",children:[Z.jsx(A,{className:"w-4 h-4 text-gray-500"}),Z.jsx("span",{className:"text-gray-600",children:"PnL:"}),Z.jsxs("span",{className:`font-semibold ${x(s.pnlPercentage)}`,children:[s.pnlPercentage>0?"+":"",s.pnlPercentage.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"flex items-center space-x-1",children:[Z.jsx("span",{className:"text-gray-600",children:"USD:"}),Z.jsxs("span",{className:`font-semibold ${x(s.pnlUSD)}`,children:["$",s.pnlUSD>0?"+":"",s.pnlUSD.toFixed(2)]})]}),Z.jsxs("div",{className:"flex items-center space-x-1",children:[Z.jsx("span",{className:"text-gray-600",children:"Durum:"}),Z.jsx("span",{className:`font-semibold ${u(s.status)}`,children:p(s.status)})]}),Z.jsxs("div",{className:"flex items-center space-x-1",children:[Z.jsx(z,{className:"w-4 h-4 text-gray-500"}),Z.jsx("span",{className:"text-gray-600",children:new Date(s.lastUpdated).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]})]}),Z.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[Z.jsxs("div",{className:"text-center",children:[Z.jsx("div",{className:"text-gray-500",children:"TP1"}),Z.jsxs("div",{className:s.tp1Distance>0?"text-green-600":"text-red-600",children:[s.tp1Distance>0?"+":"",s.tp1Distance.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"text-center",children:[Z.jsx("div",{className:"text-gray-500",children:"TP2"}),Z.jsxs("div",{className:s.tp2Distance>0?"text-green-600":"text-red-600",children:[s.tp2Distance>0?"+":"",s.tp2Distance.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"text-center",children:[Z.jsx("div",{className:"text-gray-500",children:"TP3"}),Z.jsxs("div",{className:s.tp3Distance>0?"text-green-600":"text-red-600",children:[s.tp3Distance>0?"+":"",s.tp3Distance.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"text-center",children:[Z.jsx("div",{className:"text-gray-500",children:"SL"}),Z.jsxs("div",{className:s.slDistance>0?"text-red-600":"text-green-600",children:[s.slDistance>0?"+":"",s.slDistance.toFixed(1),"%"]})]})]})]}),t.reasoning&&Z.jsxs("div",{className:"mt-3",children:[Z.jsx("p",{className:"text-sm text-gray-700",children:d.has(t.id)?t.reasoning:t.reasoning.length>150?t.reasoning.substring(0,150)+"...":t.reasoning}),t.reasoning.length>150&&Z.jsx("button",{onClick:()=>(e=>{const t=new Set(d);t.has(e)?t.delete(e):t.add(e),m(t)})(t.id),className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center space-x-1",children:d.has(t.id)?Z.jsxs(Z.Fragment,{children:[Z.jsx("span",{children:"Daha Az Göster"}),Z.jsx(L,{className:"w-4 h-4"})]}):Z.jsxs(Z.Fragment,{children:[Z.jsx("span",{children:"Detayları Gör"}),Z.jsx(I,{className:"w-4 h-4"})]})})]})]},t.id)})})]})]})},be=({onPermissionChange:e})=>{const[t,s]=a.useState("default"),[i,r]=a.useState(!1);a.useEffect(()=>{"Notification"in window&&(s(Notification.permission),r("granted"===Notification.permission))},[]);return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4",children:[Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[i?Z.jsx($,{className:"w-5 h-5 text-green-600"}):Z.jsx(E,{className:"w-5 h-5 text-gray-400"}),Z.jsxs("div",{children:[Z.jsx("h3",{className:"font-medium text-gray-900",children:"Bildirimler"}),Z.jsx("p",{className:`text-sm ${(()=>{switch(t){case"granted":return i?"text-green-600":"text-yellow-600";case"denied":return"text-red-600";default:return"text-gray-600"}})()}`,children:(()=>{switch(t){case"granted":return i?"Bildirimler Açık":"Bildirimler Kapalı";case"denied":return"Bildirimler Reddedildi";default:return"Bildirim İzni Gerekli"}})()})]})]}),Z.jsx("div",{className:"flex items-center space-x-2",children:Z.jsx("button",{onClick:()=>{"granted"===t?(r(!i),localStorage.setItem("notifications_enabled",(!i).toString())):(async()=>{if("Notification"in window)try{const t=await Notification.requestPermission();s(t);const a="granted"===t;r(a),e&&e(a),a&&new Notification("Crypto AI Trader",{body:"Bildirimler başarıyla etkinleştirildi!",icon:"/favicon.ico",tag:"test-notification"})}catch(t){console.error("Bildirim izni alınamadı:",t)}else alert("Bu tarayıcı bildirim desteği sunmuyor.")})()},className:"px-3 py-1 rounded-md text-sm font-medium transition-colors "+(i?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"granted"===t?i?"Kapat":"Aç":"İzin Ver"})})]}),"denied"===t&&Z.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-md",children:Z.jsx("p",{className:"text-sm text-red-700",children:"Bildirimler reddedildi. Tarayıcı ayarlarından izin verebilirsiniz."})}),i&&Z.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-md",children:Z.jsx("p",{className:"text-sm text-green-700",children:"✅ TP/SL ulaşıldığında bildirim alacaksınız"})})]})},fe=()=>{const[e,t]=a.useState({totalSignals:0,activeSignals:0,closedSignals:0,profitableSignals:0,lossSignals:0,totalPnL:0,averagePnL:0,winRate:0,bestTrade:0,worstTrade:0});a.useEffect(()=>{s();const e=setInterval(s,3e4);return()=>clearInterval(e)},[]);const s=()=>{try{const e=pe.getStats();t(e)}catch(e){console.error("İstatistikler yüklenemedi:",e)}},i=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),l=e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600";return Z.jsxs("div",{className:"space-y-6",children:[Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[Z.jsx(v,{className:"w-8 h-8 text-blue-600"}),Z.jsxs("div",{children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Performans İstatistikleri"}),Z.jsx("p",{className:"text-gray-600",children:"Sinyal takip ve performans analizi"})]})]}),Z.jsx("div",{className:"w-80",children:Z.jsx(be,{})})]})}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam Sinyaller"}),Z.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.totalSignals})]}),Z.jsx(j,{className:"w-8 h-8 text-blue-600"})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aktif Sinyaller"}),Z.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.activeSignals})]}),Z.jsx(z,{className:"w-8 h-8 text-blue-600"})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Kapalı Sinyaller"}),Z.jsx("p",{className:"text-2xl font-bold text-gray-600",children:e.closedSignals})]}),Z.jsx(f,{className:"w-8 h-8 text-gray-600"})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Başarı Oranı"}),Z.jsxs("p",{className:`text-2xl font-bold ${l(e.winRate)}`,children:[e.winRate.toFixed(1),"%"]})]}),Z.jsx(R,{className:"w-8 h-8 text-green-600"})]})})]}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam PnL"}),Z.jsx("p",{className:`text-2xl font-bold ${l(e.totalPnL)}`,children:i(e.totalPnL)})]}),Z.jsx(A,{className:`w-8 h-8 ${l(e.totalPnL)}`})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ortalama PnL"}),Z.jsx("p",{className:`text-2xl font-bold ${l(e.averagePnL)}`,children:i(e.averagePnL)})]}),Z.jsx(v,{className:`w-8 h-8 ${l(e.averagePnL)}`})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En İyi Trade"}),Z.jsx("p",{className:"text-2xl font-bold text-green-600",children:i(e.bestTrade)})]}),Z.jsx(r,{className:"w-8 h-8 text-green-600"})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En Kötü Trade"}),Z.jsx("p",{className:"text-2xl font-bold text-red-600",children:i(e.worstTrade)})]}),Z.jsx(n,{className:"w-8 h-8 text-red-600"})]})})]}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Kar/Zarar Dağılımı"}),Z.jsxs("div",{className:"space-y-4",children:[Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),Z.jsx("span",{className:"text-sm text-gray-600",children:"Karlı Sinyaller"})]}),Z.jsxs("div",{className:"text-right",children:[Z.jsx("span",{className:"font-semibold text-green-600",children:e.profitableSignals}),Z.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",e.closedSignals>0?(e.profitableSignals/e.closedSignals*100).toFixed(1):0,"%)"]})]})]}),Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),Z.jsx("span",{className:"text-sm text-gray-600",children:"Zararlı Sinyaller"})]}),Z.jsxs("div",{className:"text-right",children:[Z.jsx("span",{className:"font-semibold text-red-600",children:e.lossSignals}),Z.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",e.closedSignals>0?(e.lossSignals/e.closedSignals*100).toFixed(1):0,"%)"]})]})]}),Z.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:Z.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:(e.closedSignals>0?e.profitableSignals/e.closedSignals*100:0)+"%"}})})]})]}),Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Performans Özeti"}),Z.jsxs("div",{className:"space-y-3",children:[Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("span",{className:"text-sm text-gray-600",children:"Toplam İşlem Hacmi"}),Z.jsx("span",{className:"font-semibold",children:i(1e3*e.totalSignals)})]}),Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("span",{className:"text-sm text-gray-600",children:"ROI"}),Z.jsx("span",{className:`font-semibold ${l(e.totalPnL)}`,children:e.totalSignals>0?(o=e.totalPnL/(1e3*e.totalSignals)*100,`${o>0?"+":""}${o.toFixed(2)}%`):"0.00%"})]}),Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("span",{className:"text-sm text-gray-600",children:"Sharpe Ratio"}),Z.jsx("span",{className:"font-semibold text-gray-600",children:e.closedSignals>0?(e.averagePnL/Math.max(Math.abs(e.worstTrade),1)).toFixed(2):"0.00"})]}),Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("span",{className:"text-sm text-gray-600",children:"Max Drawdown"}),Z.jsx("span",{className:"font-semibold text-red-600",children:i(Math.abs(e.worstTrade))})]})]})]})]}),Z.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-start space-x-3",children:[Z.jsx(v,{className:"w-5 h-5 text-blue-600 mt-0.5"}),Z.jsxs("div",{children:[Z.jsx("h4",{className:"font-semibold text-blue-800",children:"İstatistik Bilgileri"}),Z.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["• PnL hesaplamaları $1000 pozisyon büyüklüğü varsayımı ile yapılmaktadır",Z.jsx("br",{}),"• İstatistikler her 30 saniyede bir otomatik güncellenir",Z.jsx("br",{}),"• Başarı oranı sadece kapalı sinyaller üzerinden hesaplanır",Z.jsx("br",{}),"• ROI = (Toplam PnL / Toplam Yatırım) × 100"]})]})]})})]});var o},ve=()=>{const[e,t]=a.useState([]),[s,i]=a.useState(null),[r,n]=a.useState("all"),[l,o]=a.useState("all");a.useEffect(()=>{c(),d()},[]);const c=()=>{const e=ue.getSignalHistory();t(e)},d=()=>{const e=ue.getPerformanceStats();i(e)},m=e.filter(e=>{if("profitable"===r&&(!e.pnlPercentage||e.pnlPercentage<=0))return!1;if("loss"===r&&(!e.pnlPercentage||e.pnlPercentage>=0))return!1;if("all"!==l&&e.closedAt){const t=new Date,a=new Date(e.closedAt),s=(t.getTime()-a.getTime())/36e5;if("24h"===l&&s>24)return!1;if("7d"===l&&s>168)return!1;if("30d"===l&&s>720)return!1}return!0}),g=e=>{switch(e){case"tp_hit":return"text-green-600 bg-green-100";case"sl_hit":return"text-red-600 bg-red-100";case"time_expired":return"text-yellow-600 bg-yellow-100";case"manual":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},h=e=>{switch(e){case"tp_hit":return"Hedef Vurdu";case"sl_hit":return"Stop Loss";case"time_expired":return"Süre Doldu";case"manual":return"Manuel Kapatıldı";default:return e}};return Z.jsxs("div",{className:"space-y-6",children:[Z.jsxs("div",{className:"flex items-center justify-between",children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Kapalı Sinyaller & Performans"}),Z.jsx("button",{onClick:()=>{c(),d()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"🔄 Yenile"})]}),s&&Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Toplam Sinyal"}),Z.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.totalSignals})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"}),Z.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[s.successRate.toFixed(1),"%"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Toplam PnL"}),Z.jsxs("div",{className:"text-2xl font-bold "+(s.totalPnL>=0?"text-green-600":"text-red-600"),children:[s.totalPnL>=0?"+":"",s.totalPnL.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Ortalama PnL"}),Z.jsxs("div",{className:"text-2xl font-bold "+(s.averagePnL>=0?"text-green-600":"text-red-600"),children:[s.averagePnL>=0?"+":"",s.averagePnL.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"En İyi İşlem"}),Z.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",s.bestTrade.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"En Kötü İşlem"}),Z.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[s.worstTrade.toFixed(2),"%"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Long Başarı"}),Z.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.longSuccessRate.toFixed(1),"%"]}),Z.jsxs("div",{className:"text-xs text-gray-500",children:[s.longSignals," sinyal"]})]}),Z.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[Z.jsx("div",{className:"text-sm text-gray-600",children:"Short Başarı"}),Z.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[s.shortSuccessRate.toFixed(1),"%"]}),Z.jsxs("div",{className:"text-xs text-gray-500",children:[s.shortSignals," sinyal"]})]})]}),Z.jsxs("div",{className:"flex flex-wrap gap-4",children:[Z.jsxs("div",{className:"flex gap-2",children:[Z.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Durum:"}),["all","profitable","loss"].map(e=>Z.jsx("button",{onClick:()=>n(e),className:"px-3 py-1 rounded text-sm "+(r===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"all"===e?"Tümü":"profitable"===e?"Karlı":"Zararlı"},e))]}),Z.jsxs("div",{className:"flex gap-2",children:[Z.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Zaman:"}),["all","24h","7d","30d"].map(e=>Z.jsx("button",{onClick:()=>o(e),className:"px-3 py-1 rounded text-sm "+(l===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"all"===e?"Tümü":e},e))]})]}),Z.jsxs("div",{className:"bg-white rounded-lg shadow",children:[Z.jsx("div",{className:"p-4 border-b",children:Z.jsxs("h3",{className:"text-lg font-semibold",children:["Kapalı Sinyaller (",m.length,")"]})}),Z.jsxs("div",{className:"overflow-x-auto",children:[Z.jsxs("table",{className:"w-full",children:[Z.jsx("thead",{className:"bg-gray-50",children:Z.jsxs("tr",{children:[Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Coin"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Yön"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Giriş"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Çıkış"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PnL"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Durum"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Süre"}),Z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Kapatılma"})]})}),Z.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(e=>{var t;return Z.jsxs("tr",{className:"hover:bg-gray-50",children:[Z.jsxs("td",{className:"px-4 py-3",children:[Z.jsx("div",{className:"font-medium text-gray-900",children:e.coinSymbol}),Z.jsx("div",{className:"text-sm text-gray-500",children:e.coinName})]}),Z.jsx("td",{className:"px-4 py-3",children:Z.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+("long"===e.direction?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.direction.toUpperCase()})}),Z.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",e.entryPrice.toFixed(4)]}),Z.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["$",(null==(t=e.closedPrice)?void 0:t.toFixed(4))||"N/A"]}),Z.jsx("td",{className:"px-4 py-3",children:Z.jsxs("span",{className:"text-sm font-medium "+((e.pnlPercentage||0)>=0?"text-green-600":"text-red-600"),children:[(e.pnlPercentage||0)>=0?"+":"",(e.pnlPercentage||0).toFixed(2),"%"]})}),Z.jsx("td",{className:"px-4 py-3",children:Z.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g(e.status)}`,children:h(e.status)})}),Z.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.closedAt&&e.createdAt?`${Math.round((new Date(e.closedAt).getTime()-new Date(e.createdAt).getTime())/6e4)} dk`:"N/A"}),Z.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.closedAt?new Date(e.closedAt).toLocaleString("tr-TR"):"N/A"})]},e.id)})})]}),0===m.length&&Z.jsx("div",{className:"text-center py-8 text-gray-500",children:"Henüz kapalı sinyal bulunmuyor."})]})]})]})};const ke=new class{constructor(){t(this,"intervalId",null),t(this,"isRunning",!1),t(this,"scanCount",0),t(this,"lastScanTime",null),t(this,"listeners",[]),t(this,"SCAN_INTERVAL",3e5),this.loadState()}start(){this.isRunning?console.log("🔄 Otomatik tarama zaten çalışıyor"):(this.isRunning=!0,console.log("🚀 Otomatik tarama sistemi başlatıldı - Her 5 dakikada bir tarama"),this.performScan(),this.intervalId=setInterval(()=>{this.performScan()},this.SCAN_INTERVAL),this.saveState(),this.notifyListeners())}stop(){this.isRunning?(this.isRunning=!1,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),console.log("⏹️ Otomatik tarama sistemi durduruldu"),this.saveState(),this.notifyListeners()):console.log("⏹️ Otomatik tarama zaten durmuş")}async performScan(){try{console.log(`🔍 Otomatik tarama başlatılıyor... (${this.scanCount+1}. tarama)`),this.lastScanTime=new Date;const e=await ue.generateProfessionalSignals();if(e&&e.length>0){for(const t of e)pe.addSignal(t);console.log(`✅ ${e.length} yeni sinyal üretildi ve takibe eklendi`)}else console.log("ℹ️ Bu taramada yeni sinyal bulunamadı");this.scanCount++,this.saveState(),this.notifyListeners()}catch(e){console.error("❌ Otomatik tarama hatası:",e)}}async triggerManualScan(){console.log("🔧 Manuel tarama tetiklendi"),await this.performScan()}getStatus(){return{isRunning:this.isRunning,scanCount:this.scanCount,lastScanTime:this.lastScanTime,nextScanTime:this.getNextScanTime(),intervalMinutes:this.SCAN_INTERVAL/6e4}}getNextScanTime(){return this.isRunning&&this.lastScanTime?new Date(this.lastScanTime.getTime()+this.SCAN_INTERVAL):null}addListener(e){this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}notifyListeners(){const e=this.getStatus();this.listeners.forEach(t=>t(e))}saveState(){var e;const t={isRunning:this.isRunning,scanCount:this.scanCount,lastScanTime:null==(e=this.lastScanTime)?void 0:e.toISOString()};localStorage.setItem("crypto_ai_trader_auto_scan",JSON.stringify(t))}loadState(){try{const e=localStorage.getItem("crypto_ai_trader_auto_scan");if(e){const t=JSON.parse(e);this.scanCount=t.scanCount||0,this.lastScanTime=t.lastScanTime?new Date(t.lastScanTime):null,t.isRunning&&setTimeout(()=>this.start(),1e3)}}catch(e){console.error("❌ Auto scan state yükleme hatası:",e)}}getRemainingSeconds(){if(!this.isRunning||!this.lastScanTime)return 0;const e=this.getNextScanTime();if(!e)return 0;const t=new Date;return Math.max(0,Math.floor((e.getTime()-t.getTime())/1e3))}};"undefined"!=typeof window&&(window.autoScanService=ke);const je=()=>{const[e,t]=a.useState(ke.getStatus()),[s,i]=a.useState(0);a.useEffect(()=>{const e=e=>{t(e)};ke.addListener(e);const a=setInterval(()=>{const e=ke.getRemainingSeconds();i(e)},1e3);return t(ke.getStatus()),i(ke.getRemainingSeconds()),()=>{ke.removeListener(e),clearInterval(a)}},[]);const r=e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`;return Z.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Z.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[Z.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg flex items-center justify-center",children:Z.jsx(T,{className:"w-6 h-6 text-white"})}),Z.jsxs("div",{children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Otomatik Tarama Sistemi"}),Z.jsx("p",{className:"text-gray-600",children:"Her 5 dakikada bir otomatik sinyal üretimi"})]})]}),Z.jsxs("div",{className:"flex items-center space-x-2",children:[Z.jsx("div",{className:"w-3 h-3 rounded-full "+(e.isRunning?"bg-green-500 animate-pulse":"bg-red-500")}),Z.jsx("span",{className:"font-semibold "+(e.isRunning?"text-green-600":"text-red-600"),children:e.isRunning?"Aktif":"Durduruldu"})]})]}),Z.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.isRunning?Z.jsxs("button",{onClick:()=>{ke.stop()},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors flex items-center space-x-2",children:[Z.jsx(M,{className:"w-4 h-4"}),Z.jsx("span",{children:"Durdur"})]}):Z.jsxs("button",{onClick:()=>{ke.start()},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors flex items-center space-x-2",children:[Z.jsx(F,{className:"w-4 h-4"}),Z.jsx("span",{children:"Başlat"})]}),Z.jsxs("button",{onClick:()=>{ke.triggerManualScan()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors flex items-center space-x-2",children:[Z.jsx(C,{className:"w-4 h-4"}),Z.jsx("span",{children:"Manuel Tarama"})]})]}),Z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[Z.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(P,{className:"w-5 h-5 text-blue-600"}),Z.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Toplam Tarama"})]}),Z.jsx("div",{className:"text-2xl font-bold text-gray-800",children:e.scanCount})]}),Z.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(z,{className:"w-5 h-5 text-green-600"}),Z.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tarama Aralığı"})]}),Z.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[e.intervalMinutes," dk"]})]}),Z.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(C,{className:"w-5 h-5 text-purple-600"}),Z.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Son Tarama"})]}),Z.jsx("div",{className:"text-sm font-semibold text-gray-800",children:e.lastScanTime?(n=e.lastScanTime,n?n.toLocaleString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Henüz tarama yapılmadı"):"Henüz yok"})]}),Z.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Z.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Z.jsx(z,{className:"w-5 h-5 text-orange-600"}),Z.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Sonraki Tarama"})]}),Z.jsx("div",{className:"text-lg font-bold text-gray-800",children:e.isRunning&&s>0?r(s):"--:--"})]})]}),Z.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:Z.jsxs("div",{className:"flex items-start space-x-3",children:[Z.jsx(T,{className:"w-5 h-5 text-blue-600 mt-0.5"}),Z.jsxs("div",{children:[Z.jsx("h3",{className:"font-semibold text-blue-800 mb-1",children:"Sistem Durumu"}),Z.jsx("p",{className:"text-sm text-blue-700",children:e.isRunning?Z.jsxs(Z.Fragment,{children:["Otomatik tarama sistemi aktif. Sonraki tarama"," ",Z.jsx("span",{className:"font-semibold",children:s>0?r(s):"yakında"})," ","sonra gerçekleştirilecek."]}):'Otomatik tarama sistemi durduruldu. Başlatmak için "Başlat" butonuna tıklayın.'})]})]})})]});var n};function Ne(){const[e,t]=a.useState("signals"),[s,i]=a.useState([]),[n,o]=a.useState(),[c,d]=a.useState(!0),[m,g]=a.useState(""),[h,x]=a.useState(!1),[u,y]=a.useState({});a.useEffect(()=>{x(ee.openaiApiKey.startsWith("sk-")),b(),f()},[]);const b=async()=>{try{d(!0);const e=await he.getCoins(100);e&&e.length>0?(i(e),o(e[0]),console.log("✅ Coin verileri yüklendi:",e.length,"coin")):console.warn("⚠️ Coin verileri yüklenemedi")}catch(e){console.error("Coin verileri yüklenemedi:",e)}finally{d(!1)}},f=async()=>{try{const e=["bitcoin","ethereum","binancecoin","solana","cardano","chainlink","matic-network","avalanche-2","ripple","dogecoin","polkadot","litecoin","bitcoin-cash","stellar","uniswap","cosmos","ethereum-classic","monero","algorand","vechain","internet-computer","filecoin","hedera-hashgraph","the-sandbox","decentraland","axie-infinity","enjincoin","chiliz","aave"],t=await he.getRealTimePrices(e);console.log("🚀 Gerçek zamanlı fiyatlar alındı:",Object.keys(t).length,"coin");const a={};Object.keys(t).forEach(e=>{a[e]=t[e].usd}),y(a),console.log("✅ Gerçek fiyatlar yüklendi")}catch(e){console.error("Gerçek fiyatlar yüklenemedi:",e)}};return Z.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Z.jsx("header",{className:"bg-white shadow-sm border-b",children:Z.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Z.jsxs("div",{className:"flex items-center justify-between h-16",children:[Z.jsxs("div",{className:"flex items-center space-x-3",children:[Z.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:Z.jsx(r,{className:"w-5 h-5 text-white"})}),Z.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Crypto AI Trader"})]}),Z.jsxs("div",{className:"flex items-center space-x-1",children:[Z.jsx("div",{className:"w-2 h-2 rounded-full "+(h?"bg-green-500":"bg-red-500")}),Z.jsx("span",{className:"text-sm text-gray-600",children:h?"API Bağlı":"API Bağlantısız"})]})]})})}),Z.jsx("nav",{className:"bg-white border-b",children:Z.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Z.jsxs("div",{className:"flex space-x-8",children:[Z.jsxs("button",{onClick:()=>t("signals"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("signals"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(j,{className:"w-4 h-4"}),Z.jsx("span",{children:"AI Sinyaller"})]}),Z.jsxs("button",{onClick:()=>t("chat"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("chat"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(l,{className:"w-4 h-4"}),Z.jsx("span",{children:"AI Chat"})]}),Z.jsxs("button",{onClick:()=>t("analysis"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("analysis"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(v,{className:"w-4 h-4"}),Z.jsx("span",{children:"Analiz"})]}),Z.jsxs("button",{onClick:()=>t("closed-signals"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("closed-signals"===e?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(O,{className:"w-4 h-4"}),Z.jsx("span",{children:"Kapalı Sinyaller"})]}),Z.jsxs("button",{onClick:()=>t("auto-scan"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("auto-scan"===e?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(P,{className:"w-4 h-4"}),Z.jsx("span",{children:"Otomatik Tarama"})]}),Z.jsxs("button",{onClick:()=>t("stats"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("stats"===e?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(v,{className:"w-4 h-4"}),Z.jsx("span",{children:"İstatistikler"})]}),Z.jsxs("button",{onClick:()=>t("learning"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("learning"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(p,{className:"w-4 h-4"}),Z.jsx("span",{children:"Öğrenme"})]}),Z.jsxs("button",{onClick:()=>t("training"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("training"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[Z.jsx(T,{className:"w-4 h-4"}),Z.jsx("span",{children:"Eğitim"})]})]})})}),Z.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(()=>{switch(e){case"chat":return Z.jsx(se,{currentCoin:n,chartImage:m});case"analysis":return Z.jsxs("div",{className:"space-y-6",children:[Z.jsx(Q,{coins:s,selectedCoin:n,onCoinSelect:o,loading:c}),Z.jsx(ie,{onImageUpload:g}),Z.jsx(ge,{selectedCoin:n})]});case"learning":return Z.jsx(re,{});case"training":return Z.jsx(me,{});case"signals":return Z.jsx(ye,{realPrices:u});case"stats":return Z.jsx(fe,{});case"closed-signals":return Z.jsx(ve,{});case"auto-scan":return Z.jsx(je,{});default:return Z.jsx("div",{children:"Bilinmeyen sekme"})}})()})]})}X(document.getElementById("root")).render(Z.jsx(a.StrictMode,{children:Z.jsx(Ne,{})}));
